/* ===== RESET UND GRUNDLAGEN ===== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* ===== THEME SYSTEM: CSS CUSTOM PROPERTIES ===== */
:root {
    /* Tag-Modus (Standard) - WCAG AAA konform */
    --color-text-primary: #222222;
    --color-text-secondary: #444444;
    --color-text-disabled: #999999;
    --color-surface: #FAFAFA;
    --color-surface-elevated: #FFFFFF;
    --color-primary: #004B76;
    --color-primary-hover: #003A5C;
    --color-success: #005C45;
    --color-warning: #F9E03A;
    --color-warning-text: #000000;
    --color-error: #780F2D;
    --color-info: #004B76;
    --color-border: #D8D8D8;
    --color-border-strong: #0066cc;
    --color-shadow: rgba(0, 0, 0, 0.1);
    --color-shadow-strong: rgba(0, 0, 0, 0.2);
    --color-focus: #ff9900;

    /* MISSING VARIABLES - ADDED */
    --surface-color: var(--color-surface-elevated); /* For UI surfaces */
    --accent-color: var(--color-primary); /* For interactive elements */
    --surface-hover-color: #F0F0F0; /* For button hover states */
    --text-muted: var(--color-text-disabled); /* For secondary text */

    --tooltip-bg: #222222;
    --tooltip-color: #FFFFFF;
    --button-bg: #444444;
    --button-color: #EEEEEE;
    --button-hover-bg: #666666;

    /* Dimensions */
    --top-nav-height: 60px;
    --tips-footer-height: 80px;
    --sidebar-top: var(--top-nav-height);
    --focus-outline-width: 2px;
    --border-width: 1px;

    /* Transitions */
    --transition-fast: 0.2s ease;
    --transition-medium: 0.3s ease;

    /* ===== ERWEITERTE ANIMATION-VARIABLEN (V09) ===== */

    /* Erweiterte Timings */
    --transition-slow: 0.5s ease;

    /* Easing Functions - Professionelle Bewegungskurven */
    --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);         /* Material Design Standard */
    --ease-out: cubic-bezier(0.0, 0, 0.2, 1);            /* Beschleunigt am Anfang */
    --ease-in: cubic-bezier(0.4, 0, 1, 1);               /* Beschleunigt am Ende */
    --ease-smooth: cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Sehr weiche Bewegung */

    /* Sidebar-spezifische Timings */
    --sidebar-transition-duration: 0.35s;
    --sidebar-transition-easing: var(--ease-smooth);

    /* Tooltip/Modal Timings */
    --tooltip-transition: 0.2s var(--ease-out);
    --modal-transition: 0.3s var(--ease-smooth);

    /* Animation-Delays für gestaffelte Effekte */
    --animation-stagger-delay: 0.05s;
}

/* Nacht-Modus - WCAG AA/AAA konform */
[data-theme="dark"] {
    --color-text-primary: #DEDEDE;
    --color-text-secondary: #999999;
    --color-text-disabled: #616161;
    --color-surface: #121212;
    --color-surface-elevated: #1E1E1E;
    --color-primary: #5EB3FF;
    --color-primary-hover: #7EC1FF;
    --color-success: #81C784;
    --color-warning: #FFB74D;
    --color-warning-text: #000000;
    --color-error: #EF5350;
    --color-info: #5EB3FF;
    --color-border: #2C2C2C;
    --color-border-strong: #5EB3FF;
    --color-shadow: rgba(0, 0, 0, 0.3);
    --color-shadow-strong: rgba(0, 0, 0, 0.5);
    --color-focus: #FFB74D;

    /* MISSING VARIABLES - ADDED */
    --surface-color: var(--color-surface-elevated);
    --accent-color: var(--color-primary);
    --surface-hover-color: #2A2A2A;
    --text-muted: var(--color-text-disabled);

    --tooltip-bg: #222222;
    --tooltip-color: #FFFFFF;
    --button-bg: #444444;
    --button-color: #EEEEEE;
    --button-hover-bg: #666666;
 }

/* Hochkontrast Schwarz-Weiß - WCAG AAA Maximum */
[data-theme="contrast-high"] {
    --color-text-primary: #000000;
    --color-text-secondary: #000000;
    --color-text-disabled: #666666;
    --color-surface: #FFFFFF;
    --color-surface-elevated: #FFFFFF;
    --color-primary: #000080;
    --color-primary-hover: #000060;
    --color-success: #004000;
    --color-warning: #FFFF00;
    --color-warning-text: #000000;
    --color-error: #8B0000;
    --color-info: #000080;
    --color-border: #000000;
    --color-border-strong: #000000;
    --color-shadow: rgba(0, 0, 0, 0.3);
    --color-shadow-strong: rgba(0, 0, 0, 0.5);
    --color-focus: #000000;
    --border-width: 2px;
    --focus-outline-width: 4px;

    /* MISSING VARIABLES - ADDED */
    --surface-color: var(--color-surface-elevated);
    --accent-color: var(--color-primary);
    --surface-hover-color: #F0F0F0;
    --text-muted: var(--color-text-disabled);

    --tooltip-bg: #222222;
    --tooltip-color: #FFFFFF;
    --button-bg: #444444;
    --button-color: #EEEEEE;
    --button-hover-bg: #666666;
}

/* Hochkontrast Weiß-Schwarz (Invers) - WCAG AAA Maximum */
[data-theme="contrast-inverse"] {
    --color-text-primary: #FFFFFF;
    --color-text-secondary: #FFFFFF;
    --color-text-disabled: #999999;
    --color-surface: #000000;
    --color-surface-elevated: #000000;
    --color-primary: #00BFFF;
    --color-primary-hover: #00D4FF;
    --color-success: #00FF00;
    --color-warning: #FFFF00;
    --color-warning-text: #000000;
    --color-error: #FF6B6B;
    --color-info: #00BFFF;
    --color-border: #FFFFFF;
    --color-border-strong: #FFFFFF;
    --color-shadow: rgba(255, 255, 255, 0.1);
    --color-shadow-strong: rgba(255, 255, 255, 0.2);
    --color-focus: #FFFF00;
    --border-width: 2px;
    --focus-outline-width: 4px;

    /* MISSING VARIABLES - ADDED */
    --surface-color: var(--color-surface-elevated);
    --accent-color: var(--color-primary);
    --surface-hover-color: #222222;
    --text-muted: var(--color-text-disabled);

    --tooltip-bg: #222222;
    --tooltip-color: #FFFFFF;
    --button-bg: #444444;
    --button-color: #EEEEEE;
    --button-hover-bg: #666666;
}

/* Body */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    color: var(--color-text-primary);
    background-color: var(--color-surface);
    padding: 20px;
    padding-top: calc(var(--top-nav-height) + 20px);
    padding-bottom: calc(var(--tips-footer-height) + 20px);
    padding-right: 20px;
    transition: background-color var(--transition-medium), color var(--transition-medium);
}

body.tips-hidden {
    --tips-footer-height: 0px;
}

.skip-link {
    position: fixed;
    top: -40px; /* Versteckt außerhalb des Viewports */
    left: 0;
    background: var(--color-primary);
    color: white;
    padding: 8px 16px;
    text-decoration: none;
    z-index: 100;
    transition: top 0.2s;
}

.skip-link:focus {
    top: 0; /* Bei Fokus (Tab-Taste) erscheint der Link */
}

/* ===== CONTAINER ===== */
.container {
    position: absolute;
    top: var(--tips-footer-height);
    right: calc(50% - 1200px /2);
    max-width: 1200px;
    margin: 0 auto;
    background-color: var(--color-surface-elevated);
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 10px var(--color-shadow);
    transition: margin-right var(--transition-medium), background-color var(--transition-medium);
    padding-bottom: 20px;
}

/* ===== HEADER ===== */
header {
    border-bottom: 3px solid var(--color-border-strong);
    padding-bottom: 20px;
    margin-bottom: 30px;
}

h1 {
    color: var(--color-primary);
    font-size: 2em;
    margin-bottom: 10px;
    transition: color var(--transition-medium);
}

.subtitle {
    color: var(--color-text-secondary);
    font-size: 1.1em;
    transition: color var(--transition-medium);
}

/* ===== ÜBERSCHRIFTEN ===== */
h2 {
    color: var(--color-primary);
    font-size: 1.6em;
    margin-top: 30px;
    margin-bottom: 15px;
    border-bottom: 2px solid var(--color-border);
    padding-bottom: 10px;
    transition: color var(--transition-medium), border-color var(--transition-medium);
}

h3 {
    color: var(--color-primary);
    font-size: 1.3em;
    margin-top: 25px;
    margin-bottom: 12px;
    transition: color var(--transition-medium);
}

h4 {
    color: var(--color-text-primary);
    font-size: 1.1em;
    margin-top: 20px;
    margin-bottom: 10px;
    font-weight: 600;
    transition: color var(--transition-medium);
}

/* ===== CONTENT-BEREICHE ===== */
.content-section {
    margin-bottom: 40px;
    transition: opacity var(--transition-medium);
}

.content-section.out-of-focus {
    opacity: 0.4;
}

p {
    margin-bottom: 15px;
    text-align: justify;
}

strong {
    color: var(--color-primary);
    font-weight: 600;
    transition: color var(--transition-medium);
}

/* ===== DETAILEBENEN ===== */
.detail-level-1 {
    display: block;
}

.detail-level-2 {
    display: none;
    padding-left: 20px;
    border-left: 3px solid var(--color-primary);
    margin-top: 15px;
    margin-bottom: 15px;
    transition: border-color var(--transition-medium);
}

.detail-level-3 {
    display: none;
    padding-left: 20px;
    border-left: 3px solid var(--color-primary);
    margin-top: 15px;
    margin-bottom: 15px;
    background-color: var(--color-surface);
    padding: 15px;
    border-radius: 5px;
    transition: background-color var(--transition-medium), border-color var(--transition-medium);
}

/* ===== DETAIL LEVEL VISIBILITY CLASSES ===== */
.detail-level-1,
.detail-level-2,
.detail-level-3 {
    display: block;
    opacity: 1;
    transform: translateY(0);
    transition: opacity var(--transition-medium),
    transform var(--transition-medium);
}

/* Single state class for hidden elements */
.detail-level--hidden {
    display: none !important;
    opacity: 0;
    transform: translateY(-5px);
}

/* Content section focus states */
.content-section {
    transition: opacity var(--transition-medium);
}

.content-section--out-of-focus {
    opacity: 0.4;
}

/* ===== LISTEN ===== */
ul, ol {
    margin-left: 30px;
    margin-bottom: 15px;
}

li {
    margin-bottom: 8px;
}

code {
    background-color: var(--color-surface);
    padding: 2px 6px;
    border-radius: 3px;
    font-family: 'Courier New', monospace;
    transition: background-color var(--transition-medium);
}

/* ===== INFO-BOXEN ===== */
.info-box {
    background-color: var(--color-surface);
    border-left: 4px solid var(--color-info);
    padding: 15px;
    margin: 20px 0;
    border-radius: 4px;
    transition: background-color var(--transition-medium), border-color var(--transition-medium);
}

.warning-box {
    background-color: var(--color-surface);
    border-left: 4px solid var(--color-warning);
    padding: 15px;
    margin: 20px 0;
    border-radius: 4px;
    transition: background-color var(--transition-medium), border-color var(--transition-medium);
}

.tip-box {
    background-color: var(--color-surface);
    border-left: 4px solid var(--color-success);
    padding: 15px;
    margin: 20px 0;
    border-radius: 4px;
    transition: background-color var(--transition-medium), border-color var(--transition-medium);
}

/* ===== FOOTER ===== */
footer {
    margin-top: 50px;
    padding-top: 20px;
    border-top: 2px solid var(--color-border);
    text-align: center;
    color: var(--color-text-secondary);
    transition: border-color var(--transition-medium), color var(--transition-medium);
}

footer p {
    margin-bottom: 10px;
}

footer p:last-child {
    font-size: 0.9em;
}

/* Footer Actions */
.footer-actions {
    margin-top: 15px;
    text-align: center;
    min-height: 40px;
}

.footer-btn {
    padding: 10px 20px;
    background-color: var(--color-primary);
    color: var(--color-surface-elevated);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.95em;
    transition: background-color var(--transition-fast);
}

.footer-btn:hover {
    background-color: var(--color-primary-hover);
}

.footer-btn:focus {
    outline: var(--focus-outline-width) solid var(--color-focus);
    outline-offset: 2px;
}

/* ===== NOTIZBLOCK TOGGLE BUTTON ===== */
.notes-toggle {
    position: fixed;
    right: 0;
    top: calc(50% - 30px);
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 15px 10px;
    border-radius: 8px 0 0 8px;
    cursor: pointer;
    z-index: 999; /* below the agent */
    box-shadow: -2px 2px 10px rgba(0,0,0,0.2);

    /* Identische Transition wie Sidebar */
    transform: translateX(0);
    transition: transform var(--sidebar-transition-duration) var(--sidebar-transition-easing);
}

.notes-toggle:hover {
    padding-right: 15px;
    background: linear-gradient(135deg, #7c8ef5 0%, #8a5cb4 100%);
}

.notes-toggle:focus {
    outline: 3px solid var(--color-focus);
    outline-offset: 2px;
}

.toggle-icon {
    font-size: 1.5em;
    display: block;
}

/* Wenn Notizen offen: Button fährt MIT der Sidebar */
body.notes-open .notes-toggle {
    transform: translateX(-300px);  /* Exakt die Breite der Sidebar */
}

/* ===== NOTIZBLOCK SIDEBAR ===== */
.notes-sidebar {
    position: fixed;
    right: 0;
    top: var(--top-nav-height);
    width: 300px;
    height: calc(100vh - var(--top-nav-height) - var(--tips-footer-height, 0px));
    z-index: 999;
    transform: translateX(100%);
    transition: transform var(--sidebar-transition-duration) var(--sidebar-transition-easing);
    box-shadow: -2px 0 15px var(--color-shadow-strong);
    background-color: var(--color-surface-elevated);
    display: flex;
    flex-direction: column;
    border-left: 2px solid var(--color-border-strong);

    /* GPU-Beschleunigung */
    will-change: transform;
    backface-visibility: hidden;
}

body.notes-open .notes-sidebar {
    transform: translateX(0);
}

/* Opening Animation */
.notes-sidebar.opening {
    transition-timing-function: var(--ease-out);
}

/* Closing Animation */
.notes-sidebar.closing {
    transition-timing-function: var(--ease-in);
}

.notes-header {
    background-color: var(--color-primary);
    color: var(--color-surface-elevated);
    padding: 20px;
    border-bottom: 2px solid var(--color-primary-hover);
    transition: background-color var(--transition-medium);
}

.notes-header h2 {
    margin: 0;
    font-size: 1.5em;
    color: var(--color-surface-elevated);
    border: none;
}

.notes-title {
    margin: 0;
    font-size: 1.5em;
    color: var(--color-surface-elevated);
    border: none;
    flex: 1; /* Nimmt verfügbaren Platz, drückt Close-Button nach rechts */
}

.notes-content {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
}

#notes-textarea {
    width: 100%;
    height: 100%;
    min-height: 400px;
    border: 2px solid var(--color-border);
    border-radius: 5px;
    padding: 15px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 1em;
    line-height: 1.6;
    resize: none;
    background-color: var(--color-surface-elevated);
    color: var(--color-text-primary);
    transition: background-color var(--transition-medium), color var(--transition-medium), border-color var(--transition-medium);
}

#notes-textarea:focus {
    outline: 2px solid var(--color-border-strong);
    border-color: var(--color-border-strong);
}

.notes-footer {
    padding: 15px 20px;
    border-top: 2px solid var(--color-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: var(--color-surface);
    transition: background-color var(--transition-medium), border-color var(--transition-medium);
}

.btn-secondary {
    padding: 10px 15px;
    background-color: var(--color-surface);
    color: var(--color-text-primary);
    border: 2px solid var(--color-border-strong);
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9em;
    font-weight: 500;
    transition: all var(--transition-fast);
    padding: 8px;
    flex: 1;
}

.btn-secondary[data-action="time-toggle"]::before {
    content: "🕐";
    margin-right: 0.5em;
}

.btn-secondary:hover {
    background-color: var(--color-border-strong);
    color: var(--color-surface-elevated);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px var(--color-shadow);
}

.btn-secondary:active {
    transform: translateY(0);
    box-shadow: 0 1px 3px var(--color-shadow);
}

.btn-secondary:focus {
    outline: var(--focus-outline-width) solid var(--color-focus);
    outline-offset: 2px;
}

.btn-secondary.btn-secondary-destructive {
    background-color: var(--color-error);
    color: var(--color-surface-elevated);
    border-color: var(--color-error);
}

.save-indicator {
    font-size: 0.85em;
    color: var(--color-success);
    opacity: 0;
    transition: opacity var(--transition-medium);
}

.save-indicator.visible {
    opacity: 1;
}

/* ===== BARRIEREFREIHEIT ===== */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0,0,0,0);
    white-space: nowrap;
    border-width: 0;
}

/* Scroll-Highlight für Navigation-Ziele */
.scroll-highlight {
    animation: scrollHighlight 2s ease;
}

@keyframes scrollHighlight {
    0%, 100% { 
        box-shadow: none;
    }
    25%, 75% { 
        box-shadow: 0 0 0 3px var(--color-primary);
    }
    50% { 
        box-shadow: 0 0 0 5px var(--color-primary);
    }
}

/* ===== TOP NAVIGATION BAR ===== */
.top-nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--top-nav-height);
    background-color: var(--color-primary);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    box-shadow: 0 2px 10px var(--color-shadow-strong);
    z-index: 1001;
    transition: background-color var(--transition-medium);
}

.top-nav-left {
    display: flex;
    align-items: center;
    gap: 15px;
    flex: 1;
}

.top-nav-right {
    display: flex;
    align-items: center;
    gap: 15px;
}

/* ===== BREADCRUMB NAVIGATION ===== */
.breadcrumb {
    display: flex;
    align-items: center;
}

.breadcrumb-list {
    display: flex;
    align-items: center;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: 8px;
}

.breadcrumb-item {
    display: flex;
    align-items: center;
}

.breadcrumb-link {
    color: var(--color-surface-elevated);
    text-decoration: none;
    font-size: 0.95em;
    padding: 5px 10px;
    border-radius: 4px;
    transition: background-color var(--transition-fast);
}

.breadcrumb-link:hover {
    background-color: rgba(255,255,255,0.2);
}

.breadcrumb-link:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
}

.breadcrumb-separator {
    color: rgba(255,255,255,0.6);
    font-size: 1.2em;
    margin: 0 5px;
}

.breadcrumb-current {
    color: var(--color-surface-elevated);
    font-weight: bold;
    font-size: 0.95em;
    max-width: 300px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* ===== MINI DETAILGRAD-STEUERUNG ===== */
.detail-control-mini {
    display: flex;
    align-items: center;
    gap: 10px;
    background-color: rgba(255,255,255,0.1);
    padding: 8px 15px;
    border-radius: 20px;
}

.detail-label {
    color: var(--color-surface-elevated);
    font-size: 0.9em;
    font-weight: 600;
}

.detail-buttons-mini {
    display: flex;
    gap: 5px;
}

.detail-btn-mini {
    width: 32px;
    height: 32px;
    border: 2px solid var(--color-surface-elevated);
    background-color: transparent;
    color: var(--color-surface-elevated);
    font-size: 0.95em;
    font-weight: bold;
    border-radius: 50%;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.detail-btn-mini:hover {
    background-color: rgba(255,255,255,0.2);
    transform: scale(1.1);
}

.detail-btn-mini:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
}

.detail-btn-mini.active {
    background-color: var(--color-surface-elevated);
    color: var(--color-primary);
}

/* ===== HAMBURGER MENU ===== */
.menu-toggle {
    background: none;
    border: none;
    cursor: pointer;
    padding: 10px;
    margin-right: 15px;
}

.hamburger-icon {
    display: block;
    width: 25px;
    height: 20px;
    position: relative;
}

.hamburger-icon span {
    display: block;
    position: absolute;
    height: 3px;
    width: 100%;
    background: var(--color-surface-elevated);
    border-radius: 3px;
    opacity: 1;
    left: 0;
    transition: 0.25s ease-in-out;
}

.hamburger-icon span:nth-child(1) {
    top: 0;
}

.hamburger-icon span:nth-child(2) {
    top: 8px;
}

.hamburger-icon span:nth-child(3) {
    top: 16px;
}

.menu-toggle:focus {
    outline: var(--focus-outline-width) solid var(--color-focus);
    outline-offset: 2px;
    border-radius: 4px;
}

/* Menu Dropdown */
.menu-dropdown {
    position: fixed;
    top: var(--top-nav-height);
    left: 0;
    background-color: var(--color-surface-elevated);
    box-shadow: 2px 2px 10px var(--color-shadow-strong);
    border-radius: 0 0 8px 0;
    overflow: hidden;
    max-height: 0;
    opacity: 0;
    transition: all var(--transition-medium);
    z-index: 1000;
}

.menu-dropdown.open {
    max-height: 400px;
    opacity: 1;
}

.menu-item {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 15px 20px;
    border: none;
    background: var(--color-surface-elevated);
    color: var(--color-text-primary);
    text-align: left;
    cursor: pointer;
    font-size: 1em;
    transition: background-color var(--transition-fast);
    border-bottom: var(--border-width) solid var(--color-border);
}

.menu-item:hover {
    background-color: var(--color-surface);
}

.menu-item:focus {
    outline: 2px solid var(--color-primary);
    outline-offset: -2px;
}

.menu-icon {
    margin-right: 10px;
    font-size: 1.2em;
}

/* ===== NAVIGATION SIDEBAR ===== */
.nav-sidebar {
    position: fixed;
    left: -300px;
    top: var(--top-nav-height);
    width: 280px;
    height: calc(100vh - var(--top-nav-height));
    background-color: var(--color-surface);
    box-shadow: 3px 0 15px var(--color-shadow);
    transition: left var(--transition-medium), background-color var(--transition-medium);
    z-index: 998;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.nav-sidebar.open {
    left: 0;
}

.nav-sidebar-header {
    background-color: var(--color-primary);
    color: var(--color-surface-elevated);
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color var(--transition-medium);
}

.nav-sidebar-header h3 {
    margin: 0;
    font-size: 1.2em;
    color: var(--color-surface-elevated);
}

/* Close-Button für Sidebars (alle Viewports) */
.close-btn {
    background: none;
    border: none;
    color: var(--color-surface-elevated);
    font-size: 1.5em;
    cursor: pointer;
    padding: 5px 10px;
    border-radius: 4px;
    transition: background-color var(--transition-fast);
    min-width: 44px;
    min-height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
}

.close-btn:hover {
    background-color: var(--color-primary-hover);
}

.close-btn:focus {
    outline: var(--focus-outline-width) solid var(--color-focus);
    outline-offset: 2px;
}

.nav-sidebar-content {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
}

/* Navigation Tree */
.nav-tree {
    list-style: none;
    margin: 0;
    padding: 0;
}

.nav-tree li {
    margin: 0;
}

.nav-item {
    display: flex;
    align-items: center;
    padding: 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: background-color var(--transition-fast);
    user-select: none;
    color: var(--color-text-primary);
}

.nav-item:hover {
    background-color: var(--color-surface-elevated);
}

.nav-item.active {
    background-color: var(--color-primary);
    color: var(--color-surface-elevated);
    font-weight: bold;
}

.nav-item.active:hover {
    background-color: var(--color-primary-hover);
}

.nav-item:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: -2px;
}

/* ===== MODAL / VERLAUFSFENSTER ===== */
.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 2000;
    justify-content: center;
    align-items: center;
}

.modal-overlay.show {
    display: flex;
}

.modal-content {
    background-color: var(--color-surface-elevated);
    border-radius: 10px;
    width: 90%;
    max-width: 600px;
    max-height: 80vh;
    box-shadow: 0 5px 30px var(--color-shadow-strong);
    display: flex;
    flex-direction: column;
    transition: background-color var(--transition-medium);
}

.modal-header {
    background-color: var(--color-primary);
    color: var(--color-surface-elevated);
    padding: 20px;
    border-radius: 10px 10px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color var(--transition-medium);
}

.modal-header h2 {
    margin: 0;
    font-size: 1.5em;
    color: var(--color-surface-elevated);
    border: none;
    padding: 0;
}

.modal-header-actions {
    display: flex;
    gap: 10px;
}

.modal-header-btn {
    background: rgba(255,255,255,0.2);
    border: none;
    color: var(--color-surface-elevated);
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9em;
    transition: background-color var(--transition-fast);
}

.modal-header-btn:hover {
    background: rgba(255,255,255,0.3);
}

.modal-header-btn:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
}

.modal-body {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

/* ===== HISTORY SIDEBAR ===== */
#sidebar-history .history-link {
    display: block;
    width: 100%;
    padding: 12px;
    background-color: var(--color-surface-elevated);
    border: none;
    border-left: 4px solid var(--color-primary);
    border-radius: 5px;
    cursor: pointer;
    transition: all var(--transition-fast);
    text-align: left;
}

#sidebar-history .history-link:hover {
    background-color: var(--color-surface);
    border-left-width: 6px;
    transform: translateX(2px);
}

#sidebar-history .history-link:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
}

#sidebar-history .history-item-title {
    display: block;
    font-weight: bold;
    color: var(--color-primary);
    margin-bottom: 5px;
    transition: color var(--transition-medium);
}

#sidebar-history .history-item-time {
    display: block;
    font-size: 0.85em;
    color: var(--color-text-secondary);
    transition: color var(--transition-medium);
}

#sidebar-history #history-list {
    list-style: none;
    margin: 0;
    padding: 0;
}

#sidebar-history .history-empty {
    text-align: center;
    color: var(--color-text-disabled);
    padding: 40px;
    font-style: italic;
}

/* ===== TIPPS-FOOTER ===== */
.tips-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: var(--color-surface-elevated);
    padding: 15px 20px;
    box-shadow: 0 -2px 10px var(--color-shadow-strong);
    z-index: 999;
    transform: translateY(0);
    transition: transform var(--transition-medium);
    display: flex;
    align-items: center;
    gap: 15px;
}

.tips-footer.hidden {
    transform: translateY(100%);
}

/* TIPPS NAVIGATION BUTTONS */
.tips-nav-btn {
    background: rgba(255,255,255,0.2);
    border: 2px solid white;
    color: white;
    font-size: 1em;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    transition: all var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.tips-nav-btn:hover {
    background: rgba(255,255,255,0.3);
    transform: scale(1.1);
}

.tips-nav-btn:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
}

.tips-nav-btn:active {
    transform: scale(0.95);
}

/* TIPPS CONTENT */
.tips-content {
    display: flex;
    align-items: center;
    gap: 15px;
    flex: 1;
}

.tips-icon {
    font-size: 1.5em;
    flex-shrink: 0;
}

.tips-text {
    flex: 1;
    margin: 0;
    font-size: 1em;
    line-height: 1.4;
}

/* TIPPS CLOSE BUTTON */
.tips-close-btn {
    background: rgba(255,255,255,0.2);
    border: none;
    color: white;
    font-size: 1.2em;
    cursor: pointer;
    padding: 8px 12px;
    border-radius: 5px;
    transition: background-color var(--transition-fast);
    flex-shrink: 0;
}

.tips-close-btn:hover {
    background: rgba(255,255,255,0.3);
}

.tips-close-btn:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
}

/* ===== RESPONSIVE DESIGN ===== */
@media (max-width: 1024px) {
    body.notes-open .container {
        margin-right: 0;
    }

    .notes-sidebar {
        width: 100vw;  /* Vollbreite bei kleinen Viewports */
    }

    /* Notes-Toggle: Komplett nach links verschieben wenn Sidebar offen */
    body.notes-open .notes-toggle {
        transform: translateX(calc(-100vw + 0px)); /* Komplett aus Viewport */
    }

    /* WICHTIG: Close-Button muss sichtbar bleiben */
    .notes-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
    }

    .breadcrumb-current {
        max-width: 200px;
    }
    
    .detail-label {
        display: none;
    }
    
    .nav-sidebar {
        width: 100%;
        left: -100%;
    }
    
    .nav-sidebar.open {
        left: 0;
    }
    
    body.nav-sidebar-open .container {
        margin-left: 0;
    }
}

@media (max-width: 768px) {
    .container {
        padding: 15px;
    }

    h1 {
        font-size: 1.5em;
    }

    h2 {
        font-size: 1.3em;
    }
    
    .notes-toggle {
        padding: 12px 8px;
    }
    
    .top-nav {
        height: 60px;
        flex-wrap: wrap;
        padding: 5px 10px;
    }
    
    .top-nav-left {
        flex: 0 0 100%;
        justify-content: space-between;
        margin-bottom: 5px;
    }
    
    .top-nav-right {
        flex: 0 0 100%;
        justify-content: center;
    }
    
    .breadcrumb-list {
        gap: 5px;
    }
    
    .breadcrumb-link {
        font-size: 0.85em;
        padding: 3px 6px;
    }
    
    .breadcrumb-current {
        font-size: 0.85em;
        max-width: 150px;
    }
    
    .breadcrumb-separator {
        font-size: 1em;
    }
    
    .detail-control-mini {
        padding: 6px 12px;
    }
    
    .detail-btn-mini {
        width: 28px;
        height: 28px;
        font-size: 0.85em;
    }
    
    body {
        padding-top: 80px;
    }
    
    .tips-footer {
        padding: 12px 10px;
        gap: 10px;
    }
    
    .tips-nav-btn {
        width: 35px;
        height: 35px;
        font-size: 0.9em;
    }
    
    .tips-text {
        font-size: 0.9em;
    }
    
    .tips-icon {
        font-size: 1.3em;
    }
    
    .nav-sidebar {
        top: 50px;
        height: calc(100vh - 50px);
    }
    
    .modal-content {
        width: 95%;
        max-height: 90vh;
    }
}

/* ===== HIGH CONTRAST MODE ENHANCEMENTS ===== */
@media (prefers-contrast: high) {
    .notes-toggle {
        border: 3px solid var(--color-surface-elevated);
    }
    
    button {
        border-width: var(--border-width);
    }
}

/* ===== FORCED COLORS MODE (Windows High Contrast) ===== */
@media (forced-colors: active) {
    button {
        border: 2px solid ButtonText;
        background-color: ButtonFace;
        color: ButtonText;
    }
    
    a {
        color: LinkText;
    }
    
    .nav-item.active {
        background-color: Highlight;
        color: HighlightText;
    }
}

/* ===== SYSTEM PREFERENCE DETECTION ===== */
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) {
        /* Optional: Auto Dark Mode wenn keine Präferenz gespeichert */
    }
}

@media (prefers-contrast: more) {
    :root {
        --border-width: 2px;
        --focus-outline-width: 4px;
    }
}

/* ===== THEME ICON ===== */
.theme-icon {
    display: inline-grid;
    grid-template-columns: 10px 10px;
    grid-template-rows: 10px 10px;
    gap: 2px;
    margin-right: 10px;
    vertical-align: middle;
}

.theme-icon div {
    width: 10px;
    height: 10px;
    border-radius: 2px;
    transition: background-color var(--transition-medium);
}

.theme-icon div:nth-child(1) {
    background-color: var(--color-primary);  /* Primärfarbe - dominanter Eindruck */
}

.theme-icon div:nth-child(2) {
    background-color: var(--color-surface);  /* Hintergrund - zeigt Hell/Dunkel */
}

.theme-icon div:nth-child(3) {
    background-color: var(--color-success);  /* Erfolgsfarbe - Akzentfarbe */
}

.theme-icon div:nth-child(4) {
    background-color: var(--color-border-strong);  /* Border - zeigt Kontrast */
}

/* ============================================================================
 *  GENERISCHES SIDEBAR-FRAMEWORK
 *  Hinzufügen am Ende von styles.css (nach dem bestehenden Code)
 *  ============================================================================ */

/* ===== SIDEBAR CONTAINER (alle Sidebars zusammen) ===== */
/* Sidebar initial UND geschlossen: Keine Transition */
.sidebar-container {
    position: fixed;
    left: 0;  /* Anker-Punkt links */
    top: var(--top-nav-height);
    width: 280px;
    height: calc(100vh - var(--top-nav-height) - var(--tips-footer-height, 0px));
    z-index: 998;

    /* Initial komplett versteckt (nach links außerhalb) */
    transform: translateX(-100%);

    /* Smooth Transition beim Öffnen/Schließen */
    transition: transform var(--sidebar-transition-duration) var(--sidebar-transition-easing);

    box-shadow: 2px 0 15px var(--color-shadow-strong);
    background-color: var(--color-surface-elevated);

    /* GPU-Beschleunigung */
    will-change: transform;
    backface-visibility: hidden;
}

/* Geöffneter Zustand - gleitet nach rechts ins Bild */
.sidebar-container.open {
    transform: translateX(0);
}

/* Opening Animation - beschleunigt am Anfang */
.sidebar-container.opening {
    transition-timing-function: var(--ease-out);
}

/* Closing Animation - beschleunigt am Ende */
.sidebar-container.closing {
    transition-timing-function: var(--ease-in);
}

/* ===== EINZELNE SIDEBAR WRAPPER ===== */
.sidebar-wrapper {
    background-color: var(--color-surface);
    border-right: var(--border-width) solid var(--color-border);
    display: flex; /* ✅ IMMER flex, nicht none */
    flex-direction: column;
    transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
    transform: translateX(0);
    opacity: 1;
}

/* ===== TAB-HEADER (immer sichtbar) ===== */
.sidebar-tab-header {
    background-color: var(--color-primary);
    color: var(--color-surface-elevated);
    padding: 12px 15px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    border-bottom: 2px solid rgba(0, 0, 0, 0.1);
}

/* Sidebar wird ausgeblendet */
.sidebar-wrapper.closing {
    transform: translateX(-100%);
    opacity: 0;
}

/* ✅ NEU: Tab-Header Slide-Out Animation */
.sidebar-tab-header.sliding-out {
    transform: translateX(-100%);
    opacity: 0;
}

/* ===== BODY & FOOTER nur bei aktiver Sidebar ===== */
.sidebar-tab-header:hover {
    background-color: var(--color-primary-hover);
}

.sidebar-tab-header:focus {
    outline: 3px solid var(--color-focus);
    outline-offset: -3px;
}

/* not opened Sidebar is hidden */
.sidebar-wrapper:not(.open) {
    display: none !important;
}

/* Aktive Sidebar ist sichtbar */
.sidebar-wrapper.active {
    flex: 1;
    min-height: 0; /* Kritisch */
}

.sidebar-wrapper.active .sidebar-tab-header {
    background-color: var(--color-success);
}

.sidebar-tab-button {
    background: none;
    border: none;
    color: inherit;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
    padding: 0;
    font-size: 1em;
    font-weight: bold;
}

.sidebar-tab-icon {
    font-size: 1.3em;
}

.sidebar-tab-text {
    flex: 1;
    text-align: left;
}

/* ===== SUBHEADER (nur bei aktiver Sidebar) ===== */
.sidebar-subheader {
    padding: 10px 15px;
    background-color: var(--color-surface-elevated);
    border-bottom: var(--border-width) solid var(--color-border);
    display: none;
    transition: background-color var(--transition-medium);
    flex-shrink: 0;
}

.sidebar-wrapper.active .sidebar-subheader {
    display: flex;
    align-items: center;
    gap: 10px;
    animation: slideDown 0.3s ease;
}

.sidebar-wrapper .sidebar-tab-body {
    display: none;
}

.sidebar-wrapper.active .sidebar-tab-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
}

/* ===== BODY (scrollbarer Content) ===== */
.sidebar-body {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden; /* ✅ NEU: Horizontales Scrollen verhindern */
    padding: 15px;
    background-color: var(--color-surface);
    transition: background-color var(--transition-medium);
    min-height: 0; /* ✅ Wichtig für Flex-Scrolling */
}

.sidebar-wrapper.active .sidebar-body {
    animation: slideDown 0.3s ease;
}

/* ===== FOOTER (Aktionsbereich) ===== */
.sidebar-footer {
    padding: 10px 15px;
    border-top: var(--border-width) solid var(--color-border);
    background-color: var(--color-surface);
    display: none;
    transition: background-color var(--transition-medium);
    flex-shrink: 0;
}

.sidebar-wrapper.active .sidebar-footer {
    display: block;
    animation: slideDown 0.3s ease;
}

/* ===== SLIDE-DOWN ANIMATION ===== */
@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ===== SPEZIFISCHE SIDEBAR-STYLES ===== */

/* Navigation Sidebar */
.sidebar-navigation .nav-tree {
    list-style: none;
    margin: 0;
    padding: 0;
}

.sidebar-navigation .nav-tree li {
    margin: 0;
}

.sidebar-navigation .nav-item {
    display: flex;
    align-items: center;
    padding: 10px;
    cursor: pointer;
    border-radius: 5px;
    transition: background-color var(--transition-fast);
    user-select: none;
    color: var(--color-text-primary);
}

.sidebar-navigation .nav-item:hover {
    background-color: var(--color-surface-elevated);
}

.sidebar-navigation .nav-item.active {
    background-color: var(--color-primary);
    color: var(--color-surface-elevated);
    font-weight: bold;
}

.sidebar-navigation .nav-item-icon {
    margin-right: 8px;
    font-size: 0.9em;
}

/* History Sidebar */
.sidebar-history .history-list {
    list-style: none;
    margin: 0;
    padding: 0;
}

.sidebar-history .history-item {
    padding: 12px;
    border-left: 4px solid var(--color-primary);
    background-color: var(--color-surface-elevated);
    margin-bottom: 10px;
    border-radius: 5px;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.sidebar-history .history-item:hover {
    background-color: var(--color-surface);
    border-left-width: 6px;
    transform: translateX(2px);
}

.sidebar-history .history-item-title {
    font-weight: bold;
    color: var(--color-primary);
    margin-bottom: 5px;
    transition: color var(--transition-medium);
}

.sidebar-history .history-item-time {
    font-size: 0.85em;
    color: var(--color-text-secondary);
    transition: color var(--transition-medium);
}

.sidebar-history .history-empty {
    text-align: center;
    color: var(--color-text-disabled);
    padding: 40px 20px;
    font-style: italic;
}

/* ===== HISTORY CONTROL BUTTONS ===== */
.sidebar-history #history-controls-subheader button,
.sidebar-history #history-action-controls button {
    background-color: var(--color-primary);
    color: var(--color-surface-elevated);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color var(--transition-fast);
}

.sidebar-history #history-controls-subheader button:hover,
.sidebar-history #history-action-controls button:hover {
    background-color: var(--color-primary-hover);
}

.sidebar-history #history-controls-subheader button:focus,
.sidebar-history #history-action-controls button:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
}

/* ===== SIDEBAR CONTAINER (alle Sidebars zusammen) ===== */
.sidebar-container {
    position: fixed;
    left: 0;
    top: var(--top-nav-height);
    width: 280px;
    height: calc(100vh - var(--top-nav-height) - var(--tips-footer-height, 0px));
    z-index: 998;
    transform: translateX(-100%);
    /* KEINE transition hier! */
    /* ✅ NEU - Flex-Container für die Sidebars */
    display: flex;
    flex-direction: column;
}

/* Tips Footer sichtbar: Höhe anpassen */
body:not(.tips-hidden) .sidebar-container {
    height: calc(100vh - var(--top-nav-height) - var(--tips-footer-height));
}

/* Tips Footer versteckt: volle Höhe */
body.tips-hidden .sidebar-container {
    height: calc(100vh - var(--top-nav-height));
}

/* ===== SIDEBAR TAB-HEADER LAYOUT ===== */
.sidebar-tab-header {
    /* ... bestehende Styles ... */
    display: flex;
    justify-content: space-between; /* Button links, Close rechts */
    align-items: center;
    gap: 10px;
    flex-shrink: 0; /* feste Höhe für tab-header */
}

/* ===== CLOSE-BUTTON IM TAB-HEADER ===== */
.sidebar-close-btn {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: var(--color-surface-elevated);
    font-size: 1.3em;
    cursor: pointer;
    padding: 5px 10px;
    border-radius: 4px;
    transition: all var(--transition-fast);
    flex-shrink: 0;
    opacity: 0;  /* Initial unsichtbar */
    pointer-events: none;  /* Nicht klickbar wenn unsichtbar */
}

.sidebar-close-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

.sidebar-close-btn:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
}

/* Close-Button nur bei aktiver Sidebar zeigen */
.sidebar-wrapper.active .sidebar-close-btn {
    opacity: 1;  /* Sichtbar bei aktiver Sidebar */
    pointer-events: auto;  /* Klickbar */
}

/* ===== RESPONSIVE DESIGN ===== */
@media (max-width: 1024px) {
    .sidebar-container {
        width: 100%;
    }
}

@media (max-width: 768px) {
    .sidebar-tab-header {
        padding: 10px 12px;
    }

    .sidebar-tab-icon {
        font-size: 1.2em;
    }

    .sidebar-body {
        padding: 12px;
    }

    .btn-secondary {
        padding: 12px 18px;
        font-size: 1em;
        min-width: 44px;
        min-height: 44px;
    }
}

/* ===== ACCESSIBILITY ENHANCEMENTS ===== */
.sidebar-tab-button:focus {
    outline: 3px solid var(--color-focus);
    outline-offset: 2px;
}

@media (prefers-reduced-motion: reduce) {
    .sidebar-container,
    .sidebar-body,
    .sidebar-subheader,
    .sidebar-footer {
        transition: none;
        animation: none;
    }
}

/* Verstecke Subheader in Navigation-Sidebar */
#sidebar-navigation .sidebar-subheader {
    display: none !important;
}

/* Verstecke Subheader in Navigation-Sidebar */
#sidebar-navigation .sidebar-footer {
    display: none !important;
}

/* ===== SIDEBAR TAB-HEADER HOVER-EFFEKTE (V09) ===== */
.sidebar-tab-header,
.notes-header {
    /*
    transition: background-color var(--transition-fast),
    transform 1.75s var(--sidebar-transition-easing),
    opacity 1.75s var(--sidebar-transition-easing);
    */
    transition: background-color var(--transition-fast),
        transform var(--sidebar-transition-duration) var(--sidebar-transition-easing),
        opacity var(--sidebar-transition-duration) var(--sidebar-transition-easing);
}

.sidebar-tab-header:hover,
.notes-header:hover {
    background-color: var(--color-primary-hover);
}

/* ✅ NEU: Tab-Header Slide-Out Animation */
.sidebar-tab-header.sliding-out {
    transform: translateX(-100%);
    opacity: 0;
}

/* Content-Fade beim Tab-Wechsel */
/*
.sidebar-tab-body {
    opacity: 1;
    transition: opacity var(--transition-medium) var(--ease-smooth);
}

.sidebar-tab-body.fading {
    opacity: 0;
}
*/

/* Glossary Tooltip Base Styles */
.glossary-tooltip {
  position: absolute;
  visibility: hidden;
  opacity: 0;
  z-index: 1000;
  min-width: 250px;
  max-width: 300px;
  background: var(--tooltip-bg, #333);
  color: var(--tooltip-color, #fff);
  border-radius: 6px;
  padding: 0;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
  pointer-events: none;
}

/* Visible state */
.glossary-tooltip--visible {
  visibility: visible;
  opacity: 1;
  pointer-events: auto;
}

/* Tooltip header */
.glossary-tooltip__header {
  padding: 12px 16px 8px;
  border-bottom: 1px solid var(--tooltip-border, #555);
  font-size: 1.1em;
  font-weight: bold;
}

/* Tooltip content */
.glossary-tooltip__content {
  padding: 12px 16px;
  line-height: 1.4;
  font-size: 0.95em;
}

/* Tooltip footer */
.glossary-tooltip__footer {
  padding: 8px 16px 12px;
  border-top: 1px solid var(--tooltip-border, #555);
  text-align: right;
}

/* More info button */
.glossary-tooltip__more {
  background: var(--button-bg, #007cba);
  color: var(--button-color, #fff);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 0.85em;
  cursor: pointer;
  transition: background 0.2s;
}

.glossary-tooltip__more:hover {
  background: var(--button-hover-bg, #005a87);
}

/* Tooltip arrow (optional) */
.glossary-tooltip::after {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 20px;
  border-width: 6px;
  border-style: solid;
  border-color: transparent transparent var(--tooltip-bg, #333) transparent;
}


/* ===== GLOSSARY TERM STYLES ===== */

.glossary-term {
    /* Text decoration with theme colors */
    text-decoration: underline dotted var(--color-primary);
    text-decoration-thickness: 2px;
    text-underline-offset: 3px;

    /* Smooth transitions for hover effects */
    transition: all var(--transition-fast);
    transition-property: background-color, text-decoration-color, color;

    /* Cursor indication */
    cursor: pointer;

    /* Maintain text readability */
    color: inherit;
    background-color: transparent;

    /* Focus styles for accessibility */
    outline: none;
    position: relative;
}

/* Hover state - subtle background change */
.glossary-term:hover {
    background-color: var(--color-primary);
    color: var(--color-surface);
    text-decoration-color: var(--color-surface);

    /* Smooth color transition */
    transition-duration: var(--transition-medium);
}

/* Focus state for keyboard navigation */
.glossary-term:focus {
    outline: var(--focus-outline-width) solid var(--color-focus);
    outline-offset: 2px;
    background-color: var(--color-primary);
    color: var(--color-surface);
    text-decoration-color: var(--color-surface);
}

/* Active state when clicked */
.glossary-term:active {
    background-color: var(--color-primary-hover);
    transform: translateY(1px);
    transition-duration: 0.1s;
}

/* Dark theme adjustments */
/*
[data-theme="dark"] .glossary-term {
    text-decoration-color: var(--color-primary);
}

[data-theme="dark"] .glossary-term:hover {
    background-color: var(--color-primary);
    color: var(--color-surface);
    text-decoration-color: var(--color-surface);
}

[data-theme="dark"] .glossary-term:focus {
    background-color: var(--color-primary);
    color: var(--color-surface);
}
*/
/* Optional: Add a subtle scale effect on hover for more interactivity */
.glossary-term:hover {
    transform: scale(1.02);
}

.glossary-term:active {
    transform: scale(0.98);
}

/* Ensure proper spacing and line height */
.glossary-term {
    padding: 1px 2px;
    border-radius: 3px;
    line-height: inherit;
}

/* Print styles - remove interactive elements for printing */
@media print {
    .glossary-term {
        text-decoration: underline dotted #000;
        background-color: transparent !important;
        color: inherit !important;
    }

    .glossary-term:hover,
    .glossary-term:focus {
        background-color: transparent !important;
        color: inherit !important;
    }
}

/* ===== GLOSSARY MODAL STYLES ===== */

.glossary-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    padding: 20px;
    animation: modalFadeIn var(--modal-transition);
}

.glossary-modal {
    background: var(--color-surface-elevated);
    border-radius: 8px;
    box-shadow: 0 10px 30px var(--color-shadow-strong);
    max-width: 600px;
    width: 100%;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    animation: modalSlideIn var(--modal-transition);
}

.glossary-modal__header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px 0;
    border-bottom: 1px solid var(--color-border);
}

.glossary-modal__header h2 {
    margin: 0;
    color: var(--color-text-primary);
    font-size: 1.5em;
}

.glossary-modal__close {
    background: none;
    border: none;
    font-size: 2em;
    cursor: pointer;
    color: var(--color-text-secondary);
    padding: 0;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
}

.glossary-modal__close:hover {
    background: var(--color-border);
    color: var(--color-text-primary);
}

.glossary-modal__content {
    padding: 24px;
    overflow-y: auto;
    flex: 1;
}

.glossary-modal__definition,
.glossary-modal__extended,
.glossary-modal__examples {
    margin-bottom: 24px;
}

.glossary-modal__content h3 {
    color: var(--color-primary);
    margin: 0 0 12px 0;
    font-size: 1.2em;
}

.glossary-modal__content p {
    margin: 0 0 16px 0;
    line-height: 1.6;
    color: var(--color-text-primary);
}

.glossary-modal__footer {
    padding: 0 24px 20px;
    text-align: right;
}

.glossary-modal__close-btn {
    background: var(--button-bg);
    color: var(--button-color);
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 1em;
}

.glossary-modal__close-btn:hover {
    background: var(--button-hover-bg);
}

/* Animations */
@keyframes modalFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Responsive design */
@media (max-width: 768px) {
    .glossary-modal-overlay {
        padding: 10px;
    }

    .glossary-modal {
        max-height: 90vh;
    }

    .glossary-modal__header,
    .glossary-modal__content,
    .glossary-modal__footer {
        padding: 16px;
    }
}

/* ===== TOAST NOTIFICATION SYSTEM ===== */

.toast-container {
    position: fixed;
    top: 80px; /* Below top navigation */
    right: 20px;
    z-index: 10000;
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 400px;
}

.toast {
    background: var(--color-surface-elevated);
    color: var(--color-text-primary);
    border: 1px solid var(--color-border);
    border-radius: 6px;
    padding: 12px 16px;
    box-shadow: 0 4px 12px var(--color-shadow-strong);
    display: flex;
    align-items: center;
    gap: 12px;
    transform: translateX(100%);
    opacity: 0;
    transition: all var(--transition-medium);
    max-width: 100%;
}

.toast--visible {
    transform: translateX(0);
    opacity: 1;
}

.toast--success {
    border-left: 4px solid var(--color-success);
}

.toast--warning {
    border-left: 4px solid var(--color-warning);
}

.toast--error {
    border-left: 4px solid var(--color-error);
}

.toast--info {
    border-left: 4px solid var(--color-info);
}

.toast--success::before {
    content: "✓";
}

.toast--warning::before {
    content: "⚠";
}

.toast--error::before {
    content: "✗";
}

.toast--info::before {
    content: "ℹ";
}

.toast--success::before,
.toast--warning::before,
.toast--error::before,
.toast--info::before {
    flex-shrink: 0;
    font-size: 1.2em;
}

.toast__content {
    flex: 1;
    line-height: 1.4;
}

.toast__close {
    background: none;
    border: none;
    color: var(--color-text-secondary);
    cursor: pointer;
    padding: 4px;
    border-radius: 3px;
    flex-shrink: 0;
}

.toast__close:hover {
    background: var(--color-border);
    color: var(--color-text-primary);
}

.toast__close:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 1px;
}

.toast__close::before {
    content: "×";
}

/* Dark theme adjustments */
[data-theme="dark"] .toast {
    background: var(--color-surface-elevated);
    box-shadow: 0 4px 12px var(--color-shadow-strong);
}

/* Accessibility: Reduced motion */
@media (prefers-reduced-motion: reduce) {
    .toast {
        transition: opacity 0.3s ease;
    }
}

/* Responsive design */
@media (max-width: 768px) {
    .toast-container {
        right: 10px;
        left: 10px;
        top: 70px;
        max-width: none;
    }

    .toast {
        max-width: 100%;
    }
}

/* ===== FAVORITES SIDEBAR STYLES ===== */

/* Favorites sidebar */
#sidebar-favorites {
    display: flex;
    flex-direction: column;
}

/* Favorites header */
.favorites-header {
    padding: 16px;
    border-bottom: 1px solid var(--color-border);
    background: var(--color-surface);
}

.favorites-title {
    margin: 0 0 12px 0;
    font-size: 1.2em;
    font-weight: 600;
    color: var(--color-text-primary);
}

/* Folder navigation */
.favorites-folder-nav {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
}

.favorites-folder-tab {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    padding: 6px 10px;
    font-size: 0.85em;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.favorites-folder-tab:hover {
    background: var(--color-border);
    color: var(--color-text-primary);
}

.favorites-folder-tab--active {
    background: var(--color-primary);
    color: var(--color-surface);
    border-color: var(--color-primary);
}

/* Favorites content */
.favorites-content {
    flex: 1;
    overflow-y: auto;
    padding: 8px 0;
}

/* Favorites list */
.favorites-list {
    list-style: none;
    margin: 0;
    padding: 0;
}

.favorite-item {
    display: flex;
    align-items: center;
    margin: 0;
    padding: 0;
    border-bottom: 1px solid var(--color-border);
}

.favorite-item:last-child {
    border-bottom: none;
}

.favorite-link {
    flex: 1;
    background: none;
    border: none;
    text-align: left;
    padding: 12px 16px;
    cursor: pointer;
    transition: background-color var(--transition-fast);
    color: var(--color-text-primary);
}

.favorite-link:hover {
    background: var(--color-border);
}

.favorite-link:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: -2px;
}

.favorite-title {
    display: block;
    font-weight: 500;
    margin-bottom: 4px;
    line-height: 1.3;
}

.favorite-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.8em;
    color: var(--color-text-secondary);
}

.favorite-access-count,
.favorite-last-accessed {
    font-size: 0.75em;
}

/* Empty state */
.favorites-empty-state {
    padding: 1.5rem;
    display: flex;
    align-items: center;
    text-align: center;
    justify-content: center;
    min-height: 200px;
    color: var(--color-text-secondary);
}

[data-theme="dark"] .favorite-link:hover {
    background: var(--color-border-strong);
}

#sidebar-favorites .hidden {
    display: none !important;
}

/* Ensure proper visibility states for screen readers */
[aria-hidden="true"] {
    display: none;
}

.favorites-empty-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0;
    display: block; /* Ensure proper block-level styling */
}

/* ===== FAVORITES LOADING & VISUAL FEEDBACK STATES ===== */

/* Loading State */
.favorite--loading {
    position: relative;
    opacity: 0.7;
    pointer-events: none;
}

.favorite--loading::after {
    content: "";
    position: absolute;
    top: 50%;
    right: 60px;
    width: 16px;
    height: 16px;
    margin-top: -8px;
    border: 2px solid var(--color-border);
    border-top: 2px solid var(--color-primary);
    border-radius: 50%;
    animation: favorite-spin 1s linear infinite;
}

/* Removing State - Smooth fade out */
.favorite--removing {
    opacity: 0;
    transform: translateX(-20px);
    transition: all var(--transition-medium) var(--ease-in-out);
    pointer-events: none;
}

/* Success State - Checkmark flash */
.favorite--success {
    position: relative;
}

.favorite--success::before {
    content: "✓";
    position: absolute;
    top: 50%;
    right: 60px;
    transform: translateY(-50%);
    color: var(--color-success);
    font-weight: bold;
    font-size: 16px;
    animation: favorite-success-pulse 0.5s var(--ease-out) 2;
}

/* Disabled State */
.favorite--disabled {
    pointer-events: none;
    opacity: 0.6;
}

/* Enhanced hover states for favorite actions */
.favorite-link:hover,
.favorite-action:hover {
    transform: translateY(-1px);
    transition: transform var(--transition-fast) var(--ease-out);
}

.favorite-edit-btn:hover {
    background-color: var(--color-warning);
    color: var(--color-warning-text);
}

.favorite-remove-btn:hover {
    background-color: var(--color-error);
    color: var(--color-surface-elevated);
}

/* Favorite item transitions */
.favorite-item {
    transition: all var(--transition-medium) var(--ease-in-out);
    transform-origin: center;
}

/* Animations */
@keyframes favorite-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes favorite-success-pulse {
    0% {
        opacity: 0;
        transform: translateY(-50%) scale(0.8);
    }
    50% {
        opacity: 1;
        transform: translateY(-50%) scale(1.2);
    }
    100% {
        opacity: 1;
        transform: translateY(-50%) scale(1);
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .favorite--loading::after,
    .favorite--removing,
    .favorite--success::before,
    .favorite-link:hover,
    .favorite-action:hover,
    .favorite-item {
        animation: none;
        transition: none;
        transform: none;
    }

    .favorite--loading::after {
        content: "⋯";
        border: none;
        animation: none;
        font-size: 1.2em;
    }

    .favorite--success::before {
        animation: none;
        opacity: 1;
    }
}

/* ===== FAVORITES ACTION BUTTON CONSISTENCY ===== */
/* Ensure favorite link takes remaining space */
.favorite-link {
    flex: 1;
    background: none;
    border: none;
    text-align: left;
    padding: 12px 16px;
    cursor: pointer;
    transition: background-color var(--transition-fast);
    color: var(--color-text-primary);
    min-height: 60px; /* Match action button height with padding */
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* Favorite item layout */
.favorite-item {
    display: flex;
    align-items: center;
    margin: 0;
    padding: 0;
    border-bottom: 1px solid var(--color-border);
    gap: 4px;
}

.favorite-actions {
    display: flex;
    padding: 0 8px;
    gap: 4px;
    align-items: center;
}

/* ===== ENHANCED FAVORITES EMPTY STATE ===== */

.favorites-empty-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: 1rem;
    max-width: 300px;
}

.favorites-empty-icon {
    font-size: 3rem;
    opacity: 0.6;
    line-height: 1;
}

.favorites-empty-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0;
}

.favorites-empty-description {
    font-size: 0.95rem;
    line-height: 1.5;
    margin: 0;
}

.favorites-empty-actions {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
    justify-content: center;
}

.favorites-empty-suggestion {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 6px;
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast) var(--ease-out);
}

.favorites-empty-suggestion:hover {
    background: var(--color-primary);
    color: var(--color-surface-elevated);
    border-color: var(--color-primary);
    transform: translateY(-1px);
}

.favorites-empty-suggestion:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 1px;
}

/* ===== ENHANCED FOLDER TAB NAVIGATION ===== */

.favorites-folder-nav {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    padding: 12px 16px;
    background: var(--color-surface);
    border-bottom: 1px solid var(--color-border);
}

.favorites-folder-tab {
    background: var(--color-surface-elevated);
    border: 1px solid var(--color-border);
    border-radius: 20px; /* More pill-like */
    padding: 8px 16px;
    font-size: 0.85em;
    font-weight: 500;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-medium) var(--ease-out);
    position: relative;
    overflow: hidden;
}

/* Hover effect with subtle scale */
.favorites-folder-tab:hover {
    background: var(--color-surface);
    border-color: var(--color-primary);
    color: var(--color-text-primary);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px var(--color-shadow);
}

/* Active state with stronger visual prominence */
.favorites-folder-tab--active {
    background: var(--color-primary);
    color: var(--color-surface-elevated);
    border-color: var(--color-primary);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px var(--color-shadow-strong);
}

/* Focus state for keyboard navigation */
.favorites-folder-tab:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 2px;
    z-index: 1;
}

/* Subtle pulse animation for active tab */
.favorites-folder-tab--active::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 20px;
    box-shadow: 0 0 0 2px var(--color-primary);
    animation: tab-pulse 2s var(--ease-out) infinite;
    opacity: 0.6;
}

@keyframes tab-pulse {
    0%, 100% {
        opacity: 0.6;
        transform: scale(1);
    }
    50% {
        opacity: 0.3;
        transform: scale(1.02);
    }
}

/* Tab with count badges */
.favorites-folder-tab__badge {
    display: inline-block;
    background: var(--color-text-disabled);
    color: var(--color-surface-elevated);
    border-radius: 10px;
    padding: 2px 6px;
    font-size: 0.7em;
    margin-left: 6px;
    min-width: 18px;
    text-align: center;
    transition: all var(--transition-fast) var(--ease-out);
}

.favorites-folder-tab--active .favorites-folder-tab__badge {
    background: var(--color-surface-elevated);
    color: var(--color-primary);
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .favorites-folder-tab,
    .favorites-folder-tab:hover,
    .favorites-folder-tab--active {
        transition: none;
        transform: none;
        animation: none;
    }

    .favorites-folder-tab--active::after {
        animation: none;
        opacity: 0.4;
    }
}

/* ===== FAVORITES LOADING SKELETON STATES ===== */

/* Skeleton loading for initial favorites load */
.favorites-skeleton {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 16px;
}

.favorite-skeleton-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-radius: 6px;
    background: var(--color-surface);
    gap: 12px;
    animation: skeleton-pulse 2s var(--ease-in-out) infinite;
}

.favorite-skeleton-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.favorite-skeleton-line {
    height: 12px;
    border-radius: 4px;
    background: var(--color-border);
}

.favorite-skeleton-line--title {
    width: 70%;
    height: 16px;
}

.favorite-skeleton-line--meta {
    width: 50%;
    height: 10px;
}

.favorite-skeleton-actions {
    display: flex;
    gap: 8px;
}

.favorite-skeleton-action {
    width: 36px;
    height: 36px;
    border-radius: 4px;
    background: var(--color-border);
}

@keyframes skeleton-pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.7;
    }
}

/* Enhanced operation loading states */
.favorite-item--adding {
    position: relative;
    overflow: hidden;
}

.favorite-item--adding::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.4),
                                transparent
    );
    animation: shimmer 1.5s var(--ease-out) infinite;
}

@keyframes shimmer {
    0% {
        left: -100%;
    }
    100% {
        left: 100%;
    }
}

/* Batch operation states */
.favorites-container--loading .favorite-link,
.favorites-container--loading .favorite-actions button {
    pointer-events: none;
    opacity: 0.7;
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .favorite-skeleton-item {
        animation: none;
        opacity: 0.8;
    }

    .favorite-item--adding::before {
        animation: none;
        background: var(--color-surface);
    }
}

/* ===== ENHANCED FAVORITES EMPTY STATE ===== */

.favorites-empty-state {
    padding: 3rem 1.5rem;
    text-align: center;
    color: var(--color-text-secondary);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
}

.favorites-empty-icon {
    font-size: 3rem;
    opacity: 0.6;
    margin-bottom: 0.5rem;
}

.favorites-empty-description {
    font-size: 0.95rem;
    line-height: 1.5;
    max-width: 300px;
    margin: 0;
}

.favorites-empty-actions {
    display: flex;
    gap: 0.75rem;
    margin-top: 1rem;
    flex-wrap: wrap;
    justify-content: center;
}

.favorites-empty-suggestion {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 6px;
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast) var(--ease-out);
}

.favorites-empty-suggestion:hover {
    background: var(--color-primary);
    color: var(--color-surface-elevated);
    border-color: var(--color-primary);
    transform: translateY(-1px);
}

.favorites-empty-suggestion:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 1px;
}

.favorites-empty-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0;
}

/* ===== ENHANCED MICRO-INTERACTIONS & HOVER EFFECTS ===== */

/* Enhanced favorite item interactions */
.favorite-item {
    display: flex;
    align-items: center;
    margin: 0;
    padding: 0;
    border-bottom: 1px solid var(--color-border);
    gap: 4px;
    transition: all var(--transition-medium) var(--ease-out);
    transform-origin: center;
    position: relative;
}

/* Lift effect on hover */
.favorite-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px var(--color-shadow);
    border-radius: 8px;
    margin: 2px 4px;
    background: var(--color-surface-elevated);
}

/* Smooth border radius transition */
.favorite-item,
.favorite-link {
    border-radius: 6px;
    transition:
    transform var(--transition-medium) var(--ease-out),
    box-shadow var(--transition-medium) var(--ease-out),
    background-color var(--transition-fast) var(--ease-out),
    border-radius var(--transition-medium) var(--ease-out);
}

/* Enhanced favorite link hover */
.favorite-link:hover {
    background: var(--color-surface);
    transform: translateX(4px);
}

/* Click feedback effect */
.favorite-link:active {
    transform: translateX(4px) scale(0.98);
    transition-duration: 0.1s;
}

/* Action button micro-interactions */
.favorite-actions button {
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    border-radius: 6px;
    font-size: 1.1em;
    transition: all var(--transition-medium) var(--ease-out);
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    position: relative;
    overflow: hidden;
}

/* Statistics toggle button */
.favorite-details-toggle::before {
    content: "📊";
    font-size: 14px;
}

.favorite-details-toggle[aria-expanded="true"]::before {
    content: "📈";
    opacity: 1;
    background: rgba(0, 0, 0, 0.1);
}

/* Edit button */
.favorite-edit-btn::before {
    content: "🖉";
    font-size: 13px;
}

/* Remove button */
.favorite-remove-btn::before {
    content: "🗑️";
    font-size: 13px;
}

.favorite-actions button:hover {
    transform: scale(1.1) rotate(5deg);
}

.favorite-details-toggle {
    color: var(--color-info);
}

.favorite-details-toggle:hover {
    background-color: var(--color-info);
}

.favorite-edit-btn {
    color: var(--color-warning);
}

.favorite-edit-btn:hover {
    background-color: var(--color-warning);
}

.favorite-remove-btn {
    color: var(--color-error);
}

.favorite-remove-btn:hover {
    background-color: var(--color-error);
}

.favorite-actions button:focus {
    outline: 2px solid var(--color-focus);
    outline-offset: 1px;
}

/* Staggered animation for multiple favorites */
.favorite-item {
    animation: slideInUp 0.5s var(--ease-out) both;
}

/* Different delays for staggered effect */
.favorite-item:nth-child(1) { animation-delay: 0.05s; }
.favorite-item:nth-child(2) { animation-delay: 0.1s; }
.favorite-item:nth-child(3) { animation-delay: 0.15s; }
.favorite-item:nth-child(4) { animation-delay: 0.2s; }
.favorite-item:nth-child(5) { animation-delay: 0.25s; }

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Smooth removal animation */
.favorite-item.favorite--removing {
    animation: slideOutLeft 0.4s var(--ease-in) both;
}

@keyframes slideOutLeft {
    to {
        opacity: 0;
        transform: translateX(-30px);
        height: 0;
        padding-top: 0;
        padding-bottom: 0;
        margin-bottom: 0;
        border-bottom: none;
    }
}

/* Enhanced empty state suggestions */
.favorites-empty-suggestion {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 0.75rem 1.25rem;
    font-size: 0.9rem;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-medium) var(--ease-out);
    position: relative;
    overflow: hidden;
}

/* Suggestion button hover with icon animation */
.favorites-empty-suggestion:hover {
    background: var(--color-primary);
    color: var(--color-surface-elevated);
    border-color: var(--color-primary);
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 4px 12px var(--color-shadow);
}

.favorites-empty-suggestion:active {
    transform: translateY(0) scale(0.98);
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .favorite-item,
    .favorite-link,
    .favorite-action,
    .favorites-empty-suggestion {
        transition: none;
        animation: none;
        transform: none;
    }

    .favorite-item:hover {
        transform: none;
        margin: 0;
    }

    .favorite-link:hover {
        transform: none;
    }
}

/* Ripple effect for advanced micro-interaction */
.favorite-action::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition: width 0.3s, height 0.3s;
}

.favorite-action:active::after {
    width: 100%;
    height: 100%;
}

/* ===== ENHANCED FAVORITES EMPTY STATE ===== */

.favorites-empty-actions {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
    justify-content: center;
    width: 100%; /* Ensure full width for proper button sizing */
}

.favorites-empty-suggestion {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 0.75rem 1.25rem;
    font-size: 0.9rem;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast) var(--ease-out);
    position: relative;
    overflow: hidden;

    /* Consistent sizing */
    min-width: 140px; /* Minimum width for consistency */
    max-width: 200px; /* Maximum width to prevent overflow */
    flex: 1; /* Allow buttons to grow equally */
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.favorites-empty-suggestion:hover {
    background: var(--color-primary);
    color: var(--color-surface-elevated);
    border-color: var(--color-primary);
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 4px 12px var(--color-shadow);
}

.favorites-empty-suggestion:active {
    transform: translateY(0) scale(0.98);
}

/* ===== ENHANCED FAVORITES EMPTY STATE ===== */

.favorites-empty-actions {
    display: flex;
    flex-direction: column; /* Stack buttons vertically */
    gap: 0.5rem;
    width: 100%;
    align-items: center; /* Center buttons */
}

.favorites-empty-suggestion {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    font-size: 0.9rem;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-fast) var(--ease-out);
    position: relative;
    margin-bottom: 0.2rem;

    /* Consistent fixed width */
    width: 100%;
    max-width: 220px; /* Fixed maximum width */
    min-height: 44px; /* Consistent height for accessibility */

    /* Text handling */
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;

    /* Flexbox for consistent alignment */
    display: flex;
    align-items: center;
    justify-content: center;
}

.favorites-empty-suggestion:hover {
    background: var(--color-primary);
    color: var(--color-surface-elevated);
    border-color: var(--color-primary);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px var(--color-shadow);
}

.favorites-empty-suggestion:active {
    transform: translateY(0);
}

/* Tooltip for long text */
.favorites-empty-suggestion[data-tooltip] {
    position: relative;
}

.favorites-empty-suggestion[data-tooltip]:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--tooltip-bg);
    color: var(--tooltip-color);
    padding: 0.5rem 0.75rem;
    border-radius: 4px;
    font-size: 0.8rem;
    white-space: nowrap;
    z-index: 1000;
    margin-bottom: 8px;
    box-shadow: 0 2px 8px var(--color-shadow);
}

.favorites-empty-suggestion[data-tooltip]:hover::before {
    content: "";
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 5px solid transparent;
    border-top-color: var(--tooltip-bg);
    margin-bottom: -2px;
    z-index: 1001;
}

/* ============================================================================
 *  FAVORITE STARS SYSTEM - CSS Pseudo-element Approach
 *  ============================================================================ */

/* Breadcrumb Star Styles */
.breadcrumb-star-container {
    display: inline-flex;
    margin-left: 0.5rem;
}

.breadcrumb-star {
    background: none;
    border: none;
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: all 0.2s ease;
    color: var(--text-muted);
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.breadcrumb-star:hover {
    background-color: var(--hover-bg);
    transform: scale(1.1);
}

.breadcrumb-star::before {
    content: '☆'; /* Outline star - default state */
    display: inline-block;
    transition: all 0.2s ease;
}

.breadcrumb-star--active {
    color: var(--warning-color);
}

.breadcrumb-star--active::before {
    content: '⭐'; /* Filled star - active state */
}

.breadcrumb-star--loading {
    opacity: 0.6;
    cursor: wait;
}

.breadcrumb-star--loading::before {
    content: '⏳'; /* Loading state */
}

/* Navigation Star Styles */
.nav-item-star {
    background: none;
    border: none;
    font-size: 1rem;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: all 0.2s ease;
    color: var(--text-muted);
    opacity: 0.7;
    width: 1.5rem;
    height: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-left: 0.5rem;
}

.nav-item-star:hover {
    opacity: 1;
    background-color: var(--hover-bg);
    transform: scale(1.1);
}

.nav-item-star::before {
    content: '☆'; /* Outline star - default state */
    display: inline-block;
    transition: all 0.2s ease;
}

.nav-item-star--active {
    color: var(--warning-color);
    opacity: 1;
}

.nav-item-star--active::before {
    content: '⭐'; /* Filled star - active state */
}

.nav-item-star--loading {
    opacity: 0.6;
    cursor: wait;
}

.nav-item-star--loading::before {
    content: '⏳'; /* Loading state */
}

/* Ensure nav items have proper layout for stars */
.nav-item {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    width: 100%;
}

/* Screen reader only text */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* ============================================================================
   HEADER STARS SYSTEM
   ============================================================================ */

/* Header container with star */
.header-with-star {
    position: relative;
    padding-right: 2.5rem !important; /* Make space for star */
}

/* Header star base styles */
.header-star {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: all 0.2s ease;
    color: var(--text-muted);
    opacity: 0.7;
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.header-star:hover {
    opacity: 1;
    background-color: var(--hover-bg);
    transform: translateY(-50%) scale(1.1);
}

.header-star::before {
    content: '☆'; /* Outline star - default state */
    display: inline-block;
    transition: all 0.2s ease;
}

.header-star--active {
    color: var(--warning-color);
    opacity: 1;
}

.header-star--active::before {
    content: '⭐'; /* Filled star - active state */
}

.header-star--loading {
    opacity: 0.6;
    cursor: wait;
}

.header-star--loading::before {
    content: '⏳'; /* Loading state */
}

/* ============================================================================
   FAVORITES STATISTICS STYLES (Cleaned and Consolidated)
   ============================================================================ */

/*
|--------------------------------------------------------------------------
| Core Favorite Item Structure
|--------------------------------------------------------------------------
*/
.favorite-item {
    /* Initial Structure/Aesthetics */
    border: 1px solid var(--border-color);
    border-radius: 0.375rem;
    margin-bottom: 0.5rem;
    background: var(--bg-primary);
    transition: all 0.2s ease;

    /* Positioning/Stacking Context */
    position: relative; /* Needed for desktop positioning and z-index context */
    z-index: 0; /* Default stacking order */
}

/*
|--------------------------------------------------------------------------
| Favorite Main Content (The Clickable Row)
|--------------------------------------------------------------------------
*/
.favorite-main {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem; /* Base padding */
    cursor: pointer;
}

.favorite-main:hover {
    background-color: var(--hover-bg);
}

/*
|--------------------------------------------------------------------------
| Statistics Details Container (.favorite-details)
|--------------------------------------------------------------------------
*/
.favorite-details {
    display: none;
    top: 0;
    right: 100%;
    margin-right: 8px;
    background: var(--color-surface-elevated);
    border: 1px solid var(--color-border);
    border-radius: 6px;
    box-shadow: 0 4px 12px var(--color-shadow-strong);
    padding: 12px;
    min-width: 200px;
}

/* Universal show state for details on toggle */
.favorite-details-toggle[aria-expanded="true"] ~ .favorite-details {
    display: block;
}

/*
|--------------------------------------------------------------------------
| Favorite Link / Button
|--------------------------------------------------------------------------
| Consistent styling for the main link/button element inside the item.
*/
.favorite-link {
    width: auto !important;
    flex: 1;
    justify-content: flex-start;
    padding: 8px 12px !important;
    text-align: left;
}

/*
|--------------------------------------------------------------------------
| Statistics Content
|--------------------------------------------------------------------------
*/
.access-stats {
    display: flex;
    flex-direction: column;
    gap: 0.15rem;
    background: transparent !important; /* Ensure no inherited transparency (only needs to be on the container) */
}

.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.875rem; /* Base font size */
    background: transparent !important; /* CONSOLIDATED: Removed from label/value */
}

.stat-label {
    color: var(--color-text-secondary);
    font-weight: 500;
}

.stat-value {
    color: var(--color-text-primary);
    font-weight: 600;
}

/*
|--------------------------------------------------------------------------
| Favorite Actions (Container for Toggle Button / Positioning Context)
|--------------------------------------------------------------------------
*/
.favorite-actions {
    position: relative; /* Positioning context for absolute children (.favorite-details) */
}

/*
|--------------------------------------------------------------------------
| Animations
|--------------------------------------------------------------------------
*/
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-8px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes slideDown {
    from {
        max-height: 0;
        opacity: 0;
        padding-top: 0;
        padding-bottom: 0;
    }
    to {
        max-height: 500px; /* Arbitrarily large value */
        opacity: 1;
        padding-top: 0.75rem; /* Assuming this is the desired final padding */
        padding-bottom: 0.75rem; /* Assuming this is the desired final padding */
    }
}

/*
|--------------------------------------------------------------------------
| Responsive Media Queries
|--------------------------------------------------------------------------
*/

/* MOBILE: x <= 1024px - Show as inline block below the item */
@media (max-width: 1024px) {
    .favorite-item .favorite-details-toggle[aria-expanded="true"] ~ .favorite-details {
        display: flex;
        flex-direction: column;
        padding: 0.02rem 0.75rem;
        animation: slideDown 0.3s ease;
    }
}

/* MOBILE: x <= 768px - Smaller padding/font adjustments */
@media (max-width: 768px) {
    .favorite-main {
        padding: 0.5rem; /* Overrides base 0.75rem */
    }

    .favorite-details {
        padding: 0.5rem !important; /* Override all other padding */
    }

    /* Fixed Modal Styles - **UNCOMMENT IF YOU WANT A FIXED MODAL ON SMALL SCREENS** */
    /*
    .favorite-details {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        max-width: 300px;
        z-index: 10000;
    }
    */

    .stat-item {
        font-size: 0.8rem; /* Overrides base 0.875rem */
    }
}

/* DESKTOP: x > 1024px - Absolute Popover Positioning */
@media (min-width: 1025px) {
    .favorite-details-toggle[aria-expanded="true"] ~ .favorite-details {
        position: absolute; /* Break out of normal flow entirely */
        border-radius: 0.375rem;
        padding: 0.75rem;
        min-width: 240px;
        max-width: 280px;
        animation: fadeIn 0.2s ease;
        /* Calculate position relative to the toggle button */
        top: calc(100% + 4px);
        right: -8px;

    }

    /* Tooltip Arrow (Border & Content) */
    .favorite-details-toggle[aria-expanded="true"] ~ .favorite-details::before {
        content: '';
        position: absolute;
        top: -11px;
        right: 100px;
        width: 0;
        height: 0;
        border-top: 6px solid transparent;
        border-right: 6px solid transparent;
        border-bottom: 5px solid var(--color-border);
        border-left: 6px solid transparent;
    }

    .favorite-details-toggle[aria-expanded="true"] ~ .favorite-details::after {
        content: '';
        position: absolute;
        top: -9px;
        right: 98px;
        width: 0;
        height: 0;
        border-top: 6px solid transparent;
        border-right: 6px solid transparent;
        border-bottom: 5px solid var(--color-border);
        border-left: 6px solid transparent;
    }

    /* Elevate the expanded item above siblings for desktop tooltip visibility */
    .favorite-item:has(.favorite-details-toggle[aria-expanded="true"]) {
        z-index: 1;
    }

}

/**************************************************/
/* Subsection favorite                            */
/**************************************************/

/* Subsection selection button styles */
.subsection-selection-btn {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--surface-color);
    color: var(--text-color);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 12px;
    font-weight: 500;
    line-height: 1;
}

.subsection-selection-btn:hover {
    background: var(--surface-hover-color);
    border-color: var(--accent-color);
    color: var(--accent-color);
}

.subsection-selection-btn__icon::before {
    content: '🎯';
    font-size: 14px;
    line-height: 1;
    display: block;
}

.subsection-selection-btn__text {
    white-space: nowrap;
}

/* Active selection mode state */
.subsection-selection-btn--active {
    background: var(--accent-color);
    border-color: var(--accent-color);
    color: white;
}

.subsection-selection-btn--active:hover {
    background: var(--accent-hover-color);
    border-color: var(--accent-hover-color);
    color: white;
}

/* Mobile responsive touch targets */
@media (max-width: 768px) {
    .subsection-selection-btn {
        padding: 8px 12px;
        font-size: 14px;
        gap: 8px;
    }

    .subsection-selection-btn__icon::before {
        font-size: 16px;
    }
}

/* Ensure proper positioning context */
.sidebar-subheader {
    position: relative;
    padding-right: 120px; /* Make space for the button */
}

@media (max-width: 768px) {
    .sidebar-subheader {
        padding-right: 140px; /* More space on mobile */
    }
}

/* Hide text on mobile, show only icon */
@media (max-width: 768px) {
    .subsection-selection-btn__text {
        display: none;
    }

    .subsection-selection-btn {
        padding: 8px;
        width: 40px;
        justify-content: center;
    }

    .sidebar-subheader {
        padding-right: 60px;
    }
}

/* Show tooltip on mobile when icon-only */
@media (max-width: 768px) {
    .subsection-selection-btn:hover::after {
        content: 'Präzises Lesezeichen setzen';
        position: absolute;
        top: -40px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--surface-color);
        border: 1px solid var(--border-color);
        border-radius: 4px;
        padding: 4px 8px;
        font-size: 12px;
        white-space: nowrap;
        z-index: 1000;
    }
}

/********************************************/
/* sections header icons                    */
/********************************************/

/* HEADER ICONS - FIXED VERSION */
.header-with-icons {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    gap: 16px;
    max-width: calc( 2 * 32px + 21px);
}

/* Header text takes available space */
.header-with-icons > :not(.section-header-icons) {
    flex: 1;
    min-width: 0;
}

/* Icons wrapper - fixed on the right */
.section-header-icons {
    display: flex;
    gap: 8px;
    flex: none !important; /* CRITICAL FIX */
    margin-left: auto;
}

/* Button fixes - remove flex stretching */
.header-star,
.subsection-target {
    flex: none !important; /* CRITICAL FIX */
    width: 32px;
    height: 32px;
    border: 1px solid var(--border-color, #ddd);
    border-radius: 4px;
    background: var(--surface-color, #fff);
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Remove problematic positioning */
.header-star {
    position: relative !important;
    right: auto !important;
    top: auto !important;
    transform: none !important;
}

/* Icon content */
.header-star::before {
    content: '⭐';
    font-size: 16px;
}

.subsection-target::before {
    content: '🎯';
    font-size: 16px;
}

/* Active states */
.header-star--active {
    background: var(--accent-color, #0066cc);
    border-color: var(--accent-color, #0066cc);
}

.header-star--active::before {
    filter: brightness(0) invert(1);
}

/* Hover effects */
.header-star:hover,
.subsection-target:hover {
    background: var(--surface-hover-color, #f5f5f5);
    border-color: var(--accent-color, #0066cc);
    transform: translateY(-1px);
}

/* NUCLEAR FIX - REMOVE ALL EXISTING STYLES AND START FRESH */
.section-header-icons {
    all: unset !important;
    display: flex !important;
    gap: 8px !important;
    margin-left: auto !important;
}

.header-star,
.subsection-target {
    all: unset !important;
    width: 32px !important;
    height: 32px !important;
    border: 1px solid #ccc !important;
    border-radius: 4px !important;
    background: white !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
}

.header-star::before {
    content: '⭐' !important;
    font-size: 16px !important;
}

.subsection-target::before {
    content: '🎯' !important;
    font-size: 16px !important;
}

/* Active star state */
.header-star--active {
    background: #0066cc !important;
    border-color: #0066cc !important;
}

.header-star--active::before {
    filter: brightness(0) invert(1) !important;
}

/* Hover states */
.header-star:hover,
.subsection-target:hover {
    background: #f0f0f0 !important;
    border-color: #0066cc !important;
}

/* Header with proper structure */
.header-with-icons {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
}

/* Header text takes available space */
.header-text-content {
    flex: 1;
    min-width: 0;
}

/* Icons stay on the right */
.section-header-icons {
    display: flex;
    gap: 8px;
    flex-shrink: 0;
    margin-left: 16px;
}

/* Button styles */
.header-star,
.subsection-target {
    width: 32px;
    height: 32px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

h1:has(.header-with-icons),
h2:has(.header-with-icons),
h3:has(.header-with-icons),
h4:has(.header-with-icons),
h5:has(.header-with-icons),
h6:has(.header-with-icons)
{
    display: flex;
}

/*****************************/
/* footer quickfix           */
/*****************************/
/*
.content-footer {
    display: none !important;
}
*/
/* ============================================================================
   SUBSECTION SELECTION STYLES - CLEAN VERSION
   ============================================================================ */

/* Active state for sidebar subsection button */
.subsection-selection-btn--active {
    background: var(--accent-color) !important;
    border-color: var(--accent-color) !important;
    color: white !important;
}

.subsection-selection-btn--active .subsection-selection-btn__icon::before {
    filter: brightness(0) invert(1) !important;
}

/* Selection mode - blur chrome elements, keep main clear */
.subsection-selection--active .app-chrome {
    filter: blur(3px);
    opacity: 0.8;
    pointer-events: none;
    transition: all 0.3s ease;
}

/* Hide footer during selection to prevent content covering */
.subsection-selection--active footer {
    display: none !important;
}

.subsection-selection--active .app-main {
    /* Crystal clear and fully interactive */
    filter: none !important;
    opacity: 1 !important;
    pointer-events: auto !important;
}

/* Selection instructions */
/* Selection instructions - more opaque background */
.subsection-selection-instructions {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--surface-color); /* Make this more solid */
    border: 2px solid var(--accent-color);
    border-radius: 8px;
    padding: 16px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3); /* Stronger shadow */
    z-index: 10001;
    text-align: center;
    max-width: 400px;
    pointer-events: auto;

    /* Ensure good contrast */
    color: var(--text-color);
    font-weight: 500;
    backdrop-filter: none; /* Remove any transparency effects */
}

/* Make the instructions content even more readable */
.instructions-content p {
    margin: 0 0 8px 0;
    font-weight: 600; /* Bolder text */
    line-height: 1.4;
}

.instructions-hint {
    font-size: 0.9em;
    color: var(--text-color); /* Use main text color instead of muted */
    font-style: italic;
    opacity: 0.9; /* Still slightly different but readable */
}

/* Element highlighting during selection */
.subsection-element-hover {
    outline: 2px solid var(--accent-color) !important;
    background: rgba(0, 102, 204, 0.1) !important;
    cursor: pointer !important;
}

/* Cursor during selection mode */
.subsection-selection--active {
    cursor: crosshair;
}

/* Ensure footer stays at bottom in normal mode */
.app-container {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

.app-main {
    flex: 1; /* This pushes footer to bottom */
}

.app-chrome .content-footer {
    margin-top: auto; /* Footer stays at bottom */
}

/* Selection mode - blur content header and footer */
.subsection-selection--active .content-header,
.subsection-selection--active .content-footer {
    filter: blur(3px);
    opacity: 0.8;
    pointer-events: none;
}

/* Hide the floating tips footer completely */
.subsection-selection--active .tips-footer {
    display: none !important;
}

/* Main documentation content stays crystal clear */
.subsection-selection--active .app-main {
    filter: none !important;
    opacity: 1 !important;
    pointer-events: auto !important;
}

/****************************/
/* slide out sidebars       */
/****************************/

/* Sidebar transitions */
.sidebar-container,
.notes-sidebar,
.agent-sidebar {
    transition: transform 0.3s var(--ease-smooth);
}

/* Hide during selection */
.subsection-selection--active .sidebar-container {
    transform: translateX(-110%);
    pointer-events: none;
}

.subsection-selection--active .notes-sidebar,
.subsection-selection--active .agent-sidebar {
    transform: translateX(110%);
    pointer-events: none;
}

.subsection-selection--active .skip-link {
    display: none;
}

/* Main content expansion */
.app-main {
    transition: all 0.3s var(--ease-smooth);
}

.subsection-selection--active .app-main {
    width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
}

/******************************/
/* header star has subsection */
/******************************/

/* Section with subsection favorites gets a special glow */
.header-star--has-subsections {
    box-shadow: 0 0 8px var(--accent-color);
    position: relative;
}

/* Optional: tiny dot indicator */
.header-star--has-subsections::after {
    content: '';
    position: absolute;
    top: 2px;
    right: 2px;
    width: 6px;
    height: 6px;
    background: var(--accent-color);
    border-radius: 50%;
}

/********************************/
/* highlighting of subsections  */
/********************************/

.highlight-area--color {
    background-color: var(--accent-color) !important;
}

.highlight-area--transition {
    transition: background-color 0.5s ease !important;
}

/* ============================================================================
 *  FAVORITES FOLDER NAVIGATION STYLES
 *  ============================================================================ */

/* Folder Navigation Container */
.favorites-folder-nav {
    display: flex;
    gap: 4px;
    align-items: center;
    flex-wrap: wrap;
    min-height: 32px;
    margin-bottom: 12px;
}

/* Folder Tab Base Styles */
.favorites-folder-tab {
    display: flex;
    align-items: center;
    padding: 6px 12px;
    background: var(--sidebar-bg, #f5f5f5);
    border: 1px solid var(--border-color, #ddd);
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9em;
    transition: all 0.2s ease;
    color: var(--text-color, #333);
    text-decoration: none;
    white-space: nowrap;
    border: none;
    font-family: inherit;
}

.favorites-folder-tab:hover {
    background: var(--sidebar-hover, #e9e9e9);
    border-color: var(--accent-color, #007acc);
}

.favorites-folder-tab--active {
    background: var(--accent-color, #007acc);
    color: white;
    border-color: var(--accent-color, #007acc);
}

/* Folder Icons via Pseudo-elements */
.favorites-folder-tab::before {
    content: "📁";
    margin-right: 6px;
    font-size: 0.9em;
}

.favorites-folder-tab[data-folder-id="default"]::before {
    content: "⭐";
}

/* Folder Badges */
.favorites-folder-tab__badge {
    background: var(--badge-bg, #666);
    color: white;
    border-radius: 10px;
    padding: 2px 6px;
    font-size: 0.75em;
    margin-left: 6px;
    min-width: 16px;
    text-align: center;
    line-height: 1;
}

.favorites-folder-tab--active .favorites-folder-tab__badge {
    background: rgba(255, 255, 255, 0.3);
}

/* Add Folder Button */
.favorites-folder-add {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 6px;
    background: var(--sidebar-bg, #f5f5f5);
    border: 1px dashed var(--border-color, #ddd);
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9em;
    transition: all 0.2s ease;
    color: var(--text-color, #666);
    min-width: 32px;
    height: 32px;
    position: relative;
    border: none;
    font-family: inherit;
}

.favorites-folder-add::before {
    content: "+";
    font-size: 1.1em;
    font-weight: bold;
}

.favorites-folder-add:hover {
    background: var(--sidebar-hover, #e9e9e9);
    border-color: var(--accent-color, #007acc);
    color: var(--accent-color, #007acc);
}

/* ============================================================================
 *  FAVORITES FOLDER DROPDOWN - COMPACT NAVIGATION
 *  ============================================================================ */

.favorites-folder-nav {
    display: flex;
    align-items: center;
    gap: 8px;
    min-height: 40px;
    position: relative;
    flex-wrap: nowrap;
}

/* Dropdown container */
.favorites-folder-dropdown {
    position: relative;
    min-width: 200px;
    flex-shrink: 1;
}

/* Main dropdown button */
.favorites-folder-dropdown__button {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    color: var(--color-text);
    font-size: 0.9em;
    cursor: pointer;
    transition: all 0.2s ease;
    gap: 8px;
}

.favorites-folder-dropdown__button:hover {
    background: var(--surface-hover);
    border-color: var(--accent-color);
}

.favorites-folder-dropdown__button:focus {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
}

/* Dropdown arrow icon via pseudo-element */
.favorites-folder-dropdown__button::after {
    content: "▼";
    font-size: 0.7em;
    transition: transform 0.2s ease;
    opacity: 0.7;
}

.favorites-folder-dropdown--open .favorites-folder-dropdown__button::after {
    transform: rotate(180deg);
}

/* Disabled state when no custom folders */
.favorites-folder-dropdown--disabled .favorites-folder-dropdown__button {
    opacity: 0.6;
    cursor: not-allowed;
}

.favorites-folder-dropdown--disabled .favorites-folder-dropdown__button::after {
    opacity: 0.3;
}

.favorites-folder-dropdown--disabled .favorites-folder-dropdown__button:hover {
    background: var(--surface-color);
    border-color: var(--border-color);
}

/* Badges in button */
.favorites-folder-dropdown__badges {
    display: flex;
    gap: 4px;
    margin-left: auto;
}

.favorites-folder-dropdown__folder-count::before {
    content: "📁";
    margin-right: 2px;
}

.favorites-folder-dropdown__item-count::before {
    content: "⭐";
    margin-right: 2px;
}

.favorites-folder-dropdown__folder-count,
.favorites-folder-dropdown__item-count {
    background: var(--accent-color);
    color: white;
    border-radius: 10px;
    padding: 2px 6px;
    font-size: 0.8em;
    min-width: 1.2em;
    text-align: center;
}

/* Dropdown menu */
.favorites-folder-dropdown__menu {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    max-height: 300px;
    overflow-y: auto;
    z-index: 1000;
    margin-top: 4px;
}

/* Folder items */
.favorites-folder-dropdown__item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: 8px 12px;
    background: none;
    border: none;
    text-align: left;
    cursor: pointer;
    color: var(--color-text);
    font-size: 0.9em;
    transition: all 0.1s ease;
    position: relative;
}

.favorites-folder-dropdown__item:hover {
    background: var(--surface-hover);
}

.favorites-folder-dropdown__item:hover .favorites-folder-management__buttons {
    display: flex;
}

.favorites-folder-dropdown__item--active {
    background: var(--accent-color);
    color: white;
}

.favorites-folder-dropdown__item-badge {
    background: rgba(255, 255, 255, 0.2);
    color: inherit;
    border-radius: 10px;
    padding: 2px 6px;
    font-size: 0.8em;
    margin-left: 8px;
    min-width: 1.2em;
    text-align: center;
}

/* Management buttons */
.favorites-folder-management__buttons {
    display: none;
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%);
    gap: 4px;
    background: inherit;
}

/* Rename icon via pseudo-element */
.favorites-folder-rename::before {
    content: "✏️";
    font-size: 0.8em;
}

/* Delete icon via pseudo-element */
.favorites-folder-delete::before {
    content: "🗑️";
    font-size: 0.8em;
}

/* default folder can neither be renamed nor deleted */
.favorites-folder-rename[data-folder-id="default"],
.favorites-folder-delete[data-folder-id="default"] {
    display: none;
}

.favorites-folder-rename,
.favorites-folder-delete {
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px;
    border-radius: 2px;
    opacity: 0.7;
    transition: opacity 0.1s ease;
}

.favorites-folder-rename:hover,
.favorites-folder-delete:hover {
    opacity: 1;
    background: rgba(0, 0, 0, 0.1);
}

/* Create folder button */
.favorites-folder-dropdown__create {
    border-top: 1px solid var(--border-color);
    padding: 8px 12px;
    width: 100%;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--accent-color);
    font-weight: 500;
    text-align: left;
    transition: background-color 0.1s ease;
}

.favorites-folder-dropdown__create::before {
    content: "+";
    margin-right: 8px;
    font-weight: bold;
}

.favorites-folder-dropdown__create:hover {
    background: var(--surface-hover);
}

/* Empty state */
.favorites-folder-dropdown__empty {
    padding: 12px;
    text-align: center;
    color: var(--color-text-secondary);
    font-style: italic;
    font-size: 0.9em;
}

/* Ensure subsection button has proper spacing */
.subsection-selection-btn {
    margin-left: auto;
    flex-shrink: 0;
}

/* Filtered state for future tag filtering */
.filtered-out {
    display: none;
}

/*******************************/
/* fix dropdown folder menu    */
/*******************************/

.sidebar-subheader {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    padding: 8px 12px;
    border-bottom: 1px solid var(--border-color);
    min-height: 44px;
}

.favorites-folder-nav {
    display: flex;
    align-items: center;
    flex: 1;
    gap: 4px;
}

.subsection-selection-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 8px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--bg-secondary);
    white-space: nowrap;
    flex-shrink: 0;
}

/* Remove text on smaller screens */
@media (max-width: 320px) {
    .subsection-selection-btn__text {
        display: none;
    }

    .subsection-selection-btn {
        padding: 6px;
    }
}

/***********************************/
/* fix position of subsection-btn  */
/***********************************/
/* Fix subheader layout */
.sidebar-subheader {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    min-height: 44px;
    position: relative; /* Remove if already set */
}

/* Fix folder nav to be flexible */
.favorites-folder-nav {
    display: flex;
    align-items: center;
    flex: 1;
    min-width: 0;
    margin: 0 !important; /* Override any existing margins */
    padding: 0 !important; /* Override any existing padding */
}

/* Fix dropdown to take available space */
.favorites-folder-dropdown {
    flex: 1;
    min-width: 0;
    position: relative;
}

/* Fix subsection button to be part of flex flow */
.subsection-selection-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 8px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--bg-secondary);
    white-space: nowrap;
    flex-shrink: 0;

    /* REMOVE absolute positioning */
    position: static !important;
    top: auto !important;
    right: auto !important;
    transform: none !important;

    /* Ensure proper sizing */
    height: auto;
    width: auto;
}

/* Hide text on very small screens */
@media (max-width: 320px) {
    .subsection-selection-btn__text {
        display: none;
    }
    .subsection-selection-btn {
        padding: 6px;
    }
}

/***********************************/
/* Drag and Drop Styles            */
/***********************************/
/* Drag and Drop Styles - Using Theme Variables */
.favorite-item {
    transition: all 0.2s ease;
    position: relative;
}

.favorite-drag-handle {
    cursor: grab;
    padding: 8px 4px;
    color: var(--color-text-secondary);
    font-weight: bold;
    user-select: none;
    margin-right: 8px;
    transition: color 0.2s ease;
}

.favorite-drag-handle:active {
    cursor: grabbing;
    color: var(--color-accent-primary);
}

.favorite-dragging {
    opacity: 0.6;
    background-color: var(--color-background-secondary);
    border: 1px solid var(--color-accent-primary);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.drag-over-top::before {
    content: "";
    position: absolute;
    top: -2px;
    left: 8px;
    right: 8px;
    height: 3px;
    background-color: var(--color-accent-primary);
    border-radius: 2px;
}

.drag-over-bottom::after {
    content: "";
    position: absolute;
    bottom: -2px;
    left: 8px;
    right: 8px;
    height: 3px;
    background-color: var(--color-accent-primary);
    border-radius: 2px;
}

/* Folder drop target highlighting - make it very visible */
.favorites-folder-dropdown__item.drop-target {
    background-color: var(--color-background-secondary) !important;
    border: 2px dashed var(--color-accent-primary) !important;
    transform: scale(1.02);
    transition: all 0.2s ease;
}

/* Make sure the dropdown items are visible for dragging */
.favorites-folder-dropdown__item {
    position: relative;
    transition: all 0.2s ease;
}

/* Additional visual feedback for drag operations */
.favorite-item:not(.favorite-dragging) {
    transition: transform 0.2s ease, background-color 0.2s ease;
}

.favorite-item.favorite-dragging ~ .favorite-item {
    transform: translateY(0); /* Reset any transforms on siblings */
}

/* Ensure proper contrast in both light and dark themes */
@media (prefers-color-scheme: dark) {
    .favorite-drag-handle {
        color: var(--color-text-secondary);
    }

    .favorite-dragging {
        background-color: var(--color-background-secondary);
        border-color: var(--color-accent-primary);
    }

    .favorites-folder-dropdown__item.drop-target {
        background-color: var(--color-background-secondary) !important;
        border-color: var(--color-accent-primary) !important;
    }
}

/* Focus states for accessibility */
.favorite-drag-handle:focus {
    outline: 2px solid var(--color-accent-primary);
    outline-offset: 2px;
}

/* Smooth transitions for all interactive states */
.favorite-drag-handle,
.favorite-item,
.favorites-folder-dropdown__item {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}/* Drag and Drop Styles - Using Theme Variables */
.favorite-item {
    transition: all 0.2s ease;
    position: relative;
}

.favorite-drag-handle {
    cursor: grab;
    padding: 8px 4px;
    color: var(--color-text-secondary);
    font-weight: bold;
    user-select: none;
    margin-right: 8px;
    transition: color 0.2s ease;
}

.favorite-drag-handle:active {
    cursor: grabbing;
    color: var(--color-accent-primary);
}

.favorite-dragging {
    opacity: 0.6;
    background-color: var(--color-background-secondary);
    border: 1px solid var(--color-accent-primary);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.drag-over-top::before {
    content: "";
    position: absolute;
    top: -2px;
    left: 8px;
    right: 8px;
    height: 3px;
    background-color: var(--color-accent-primary);
    border-radius: 2px;
}

.drag-over-bottom::after {
    content: "";
    position: absolute;
    bottom: -2px;
    left: 8px;
    right: 8px;
    height: 3px;
    background-color: var(--color-accent-primary);
    border-radius: 2px;
}

/* Folder drop target highlighting - make it very visible */
.favorites-folder-dropdown__item.drop-target {
    background-color: var(--color-background-secondary) !important;
    border: 2px dashed var(--color-accent-primary) !important;
    transform: scale(1.02);
    transition: all 0.2s ease;
}

/* Make sure the dropdown items are visible for dragging */
.favorites-folder-dropdown__item {
    position: relative;
    transition: all 0.2s ease;
}

/* Additional visual feedback for drag operations */
.favorite-item:not(.favorite-dragging) {
    transition: transform 0.2s ease, background-color 0.2s ease;
}

.favorite-item.favorite-dragging ~ .favorite-item {
    transform: translateY(0); /* Reset any transforms on siblings */
}

/* Ensure proper contrast in both light and dark themes */
@media (prefers-color-scheme: dark) {
    .favorite-drag-handle {
        color: var(--color-text-secondary);
    }

    .favorite-dragging {
        background-color: var(--color-background-secondary);
        border-color: var(--color-accent-primary);
    }

    .favorites-folder-dropdown__item.drop-target {
        background-color: var(--color-background-secondary) !important;
        border-color: var(--color-accent-primary) !important;
    }
}

/* Focus states for accessibility */
.favorite-drag-handle:focus {
    outline: 2px solid var(--color-accent-primary);
    outline-offset: 2px;
}

/* Smooth transitions for all interactive states */
.favorite-drag-handle,
.favorite-item,
.favorites-folder-dropdown__item {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Enhanced drop target styling with theme variables */
.favorites-folder-dropdown__item.drop-target {
    background-color: var(--color-background-secondary) !important;
    border: 2px dashed var(--color-accent-primary) !important;
    transform: scale(1.02);
    transition: all 0.2s ease;
    position: relative;
}

/* Add a visual indicator for drop targets */
.favorites-folder-dropdown__item.drop-target::after {
    content: "Drop to move favorite here";
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--color-accent-primary);
    color: var(--color-background-primary);
    font-size: 0.75rem;
    padding: 4px;
    text-align: center;
    border-radius: 0 0 4px 4px;
    z-index: 1000;
}

/* Ensure folder items have proper spacing for drop targets */
.favorites-folder-dropdown__item {
    position: relative;
    transition: all 0.2s ease;
    margin: 2px 0;
    border: 1px solid transparent;
}

/* visually indicate when the empty state is a valid drop target */
.favorites-empty-state.drop-target {
    background-color: rgba(76, 175, 80, 0.1);
    border: 2px dashed #4CAF50;
    border-radius: 8px;
}


/* Make sure the cloned empty state in the list looks proper */
.favorites-list .favorites-empty-state {
    list-style: none;
    margin: 0;
    padding: 2rem;
}

/* Hide the original empty state when it's not needed */
#favorites-empty-state.hidden {
    display: none !important;
}


.favorite-item--placeholder {
    opacity: 0.6;
    border: 2px dashed #ccc !important;
    background: rgba(0, 0, 0, 0.05);
}

.favorite-item--placeholder .favorite-link {
    pointer-events: none;
}

.favorite-item--placeholder .favorite-action {
    visibility: hidden;
}

/* Move drag handles to the right side */
/* Quick drag handle repositioning */
.favorite-item {
    position: relative;
    display: flex;
    align-items: center;
    padding-right: 8px; /* Make space for drag handle */
}

.drag-handle {
    order: 999; /* Force to the end */
    margin-left: auto !important;
    cursor: grab;
    padding: 8px 4px;
    opacity: 0.4;
    transition: opacity 0.2s ease;
}

.drag-handle:hover {
    opacity: 1;
    background: rgba(0,0,0,0.05);
    border-radius: 3px;
}

/* Ensure dropdown appears above everything */
.favorites-folder-dropdown {
    z-index: 1000;
}

.favorites-folder-dropdown__menu {
    z-index: 1001;
}
